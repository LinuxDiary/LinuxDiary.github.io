<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>系统常用配置 | 个人文档库</title>
    <meta name="generator" content="VuePress 1.9.8">
    
    <meta name="description" content="运维知识文档">
    
    <link rel="preload" href="/assets/css/0.styles.86682925.css" as="style"><link rel="preload" href="/assets/js/app.6ea617b8.js" as="script"><link rel="preload" href="/assets/js/2.6e381248.js" as="script"><link rel="preload" href="/assets/js/27.164897ca.js" as="script"><link rel="prefetch" href="/assets/js/10.dd27a2bb.js"><link rel="prefetch" href="/assets/js/11.ec440828.js"><link rel="prefetch" href="/assets/js/12.c67fbef0.js"><link rel="prefetch" href="/assets/js/13.a53b31f6.js"><link rel="prefetch" href="/assets/js/14.fac02fcf.js"><link rel="prefetch" href="/assets/js/15.366e462e.js"><link rel="prefetch" href="/assets/js/16.ae609dff.js"><link rel="prefetch" href="/assets/js/17.7976f036.js"><link rel="prefetch" href="/assets/js/18.3f258419.js"><link rel="prefetch" href="/assets/js/19.0ad2626e.js"><link rel="prefetch" href="/assets/js/20.bdf3dbe2.js"><link rel="prefetch" href="/assets/js/21.04180477.js"><link rel="prefetch" href="/assets/js/22.f4cf519a.js"><link rel="prefetch" href="/assets/js/23.9e5b52cd.js"><link rel="prefetch" href="/assets/js/24.b0159ef8.js"><link rel="prefetch" href="/assets/js/25.e38d986a.js"><link rel="prefetch" href="/assets/js/26.b44e8359.js"><link rel="prefetch" href="/assets/js/28.30c3dcb6.js"><link rel="prefetch" href="/assets/js/29.0ea1763d.js"><link rel="prefetch" href="/assets/js/3.87c14ff3.js"><link rel="prefetch" href="/assets/js/30.b6b9f227.js"><link rel="prefetch" href="/assets/js/31.d7d6e5fa.js"><link rel="prefetch" href="/assets/js/32.a71c64f7.js"><link rel="prefetch" href="/assets/js/33.6e421306.js"><link rel="prefetch" href="/assets/js/34.0f46b74a.js"><link rel="prefetch" href="/assets/js/35.1d02fd3c.js"><link rel="prefetch" href="/assets/js/36.fc5cc9cb.js"><link rel="prefetch" href="/assets/js/37.af7e5661.js"><link rel="prefetch" href="/assets/js/38.cdd11312.js"><link rel="prefetch" href="/assets/js/39.30bb1d36.js"><link rel="prefetch" href="/assets/js/4.91553c08.js"><link rel="prefetch" href="/assets/js/40.c4740fee.js"><link rel="prefetch" href="/assets/js/41.37a38f62.js"><link rel="prefetch" href="/assets/js/42.df5bcbd7.js"><link rel="prefetch" href="/assets/js/43.0c0ab294.js"><link rel="prefetch" href="/assets/js/44.1dcaa2ac.js"><link rel="prefetch" href="/assets/js/45.c3b4bbca.js"><link rel="prefetch" href="/assets/js/46.7659ce01.js"><link rel="prefetch" href="/assets/js/47.d6eb360d.js"><link rel="prefetch" href="/assets/js/48.ca9d607b.js"><link rel="prefetch" href="/assets/js/49.8c09eac0.js"><link rel="prefetch" href="/assets/js/5.6d5ca1ce.js"><link rel="prefetch" href="/assets/js/50.3694eddb.js"><link rel="prefetch" href="/assets/js/51.0868c6f4.js"><link rel="prefetch" href="/assets/js/52.513df7cc.js"><link rel="prefetch" href="/assets/js/53.9dcabf12.js"><link rel="prefetch" href="/assets/js/54.70a6c075.js"><link rel="prefetch" href="/assets/js/55.a1d14f80.js"><link rel="prefetch" href="/assets/js/56.7029bd26.js"><link rel="prefetch" href="/assets/js/57.1b116307.js"><link rel="prefetch" href="/assets/js/58.bb74acae.js"><link rel="prefetch" href="/assets/js/59.610e7d4f.js"><link rel="prefetch" href="/assets/js/6.ee71a04b.js"><link rel="prefetch" href="/assets/js/60.98e611f4.js"><link rel="prefetch" href="/assets/js/61.05109453.js"><link rel="prefetch" href="/assets/js/62.f4adfb83.js"><link rel="prefetch" href="/assets/js/63.b63e1591.js"><link rel="prefetch" href="/assets/js/64.1235f2bd.js"><link rel="prefetch" href="/assets/js/65.bfa7cab9.js"><link rel="prefetch" href="/assets/js/66.2574fbb1.js"><link rel="prefetch" href="/assets/js/67.09935f72.js"><link rel="prefetch" href="/assets/js/68.af1ee108.js"><link rel="prefetch" href="/assets/js/69.7a2f9a81.js"><link rel="prefetch" href="/assets/js/7.ed4c5699.js"><link rel="prefetch" href="/assets/js/70.605c490c.js"><link rel="prefetch" href="/assets/js/8.c8b45379.js"><link rel="prefetch" href="/assets/js/9.9d028748.js">
    <link rel="stylesheet" href="/assets/css/0.styles.86682925.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">个人文档库</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="http://www.linuxd.cc/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  HOLA
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/LinuxDiary/scripts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  脚本
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="http://www.linuxd.cc/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  HOLA
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/LinuxDiary/scripts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  脚本
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>CentOS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/CentOS/boot_order.html" class="sidebar-link">启动顺序</a></li><li><a href="/CentOS/system_initialization.html" aria-current="page" class="active sidebar-link">系统常用配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/CentOS/system_initialization.html#创建sudo用户" class="sidebar-link">创建sudo用户</a></li><li class="sidebar-sub-header"><a href="/CentOS/system_initialization.html#vi别名" class="sidebar-link">vi别名</a></li><li class="sidebar-sub-header"><a href="/CentOS/system_initialization.html#关闭ipv6" class="sidebar-link">关闭ipv6</a></li><li class="sidebar-sub-header"><a href="/CentOS/system_initialization.html#history计数" class="sidebar-link">history计数</a></li><li class="sidebar-sub-header"><a href="/CentOS/system_initialization.html#ssh设置" class="sidebar-link">ssh设置</a></li><li class="sidebar-sub-header"><a href="/CentOS/system_initialization.html#ssh秘钥登录" class="sidebar-link">ssh秘钥登录</a></li><li class="sidebar-sub-header"><a href="/CentOS/system_initialization.html#升级ssh" class="sidebar-link">升级ssh</a></li><li class="sidebar-sub-header"><a href="/CentOS/system_initialization.html#修改时区" class="sidebar-link">修改时区</a></li><li class="sidebar-sub-header"><a href="/CentOS/system_initialization.html#时间同步" class="sidebar-link">时间同步</a></li><li class="sidebar-sub-header"><a href="/CentOS/system_initialization.html#设置启动内核" class="sidebar-link">设置启动内核</a></li><li class="sidebar-sub-header"><a href="/CentOS/system_initialization.html#恢复root口令" class="sidebar-link">恢复root口令</a></li><li class="sidebar-sub-header"><a href="/CentOS/system_initialization.html#设置网卡子接口" class="sidebar-link">设置网卡子接口</a></li><li class="sidebar-sub-header"><a href="/CentOS/system_initialization.html#最大文件打开数" class="sidebar-link">最大文件打开数</a></li><li class="sidebar-sub-header"><a href="/CentOS/system_initialization.html#命令行提示符颜色" class="sidebar-link">命令行提示符颜色</a></li><li class="sidebar-sub-header"><a href="/CentOS/system_initialization.html#适当减少不必要的磁盘i-o" class="sidebar-link">适当减少不必要的磁盘I/O</a></li><li class="sidebar-sub-header"><a href="/CentOS/system_initialization.html#nologin用户配置家目录" class="sidebar-link">nologin用户配置家目录</a></li><li class="sidebar-sub-header"><a href="/CentOS/system_initialization.html#常用命令" class="sidebar-link">常用命令</a></li></ul></li><li><a href="/CentOS/yum.html" class="sidebar-link">yum命令</a></li><li><a href="/CentOS/rpm.html" class="sidebar-link">rpm命令</a></li><li><a href="/CentOS/date_command_opstions.html" class="sidebar-link">date命令选项</a></li><li><a href="/CentOS/system_logs.html" class="sidebar-link">系统日志说明</a></li><li><a href="/CentOS/grep_sed_awk.html" class="sidebar-link">grep sed awk</a></li><li><a href="/CentOS/file_descriptor.html" class="sidebar-link">文件描述符</a></li><li><a href="/CentOS/stdin_stdout_stderr.html" class="sidebar-link">输入输出重定向</a></li><li><a href="/CentOS/iptables.html" class="sidebar-link">iptables</a></li><li><a href="/CentOS/sysctl.html" class="sidebar-link">sysctl基本优化</a></li><li><a href="/CentOS/load_balance.html" class="sidebar-link">双网卡绑定和负载均衡</a></li><li><a href="/CentOS/lvm.html" class="sidebar-link">lvm管理</a></li><li><a href="/CentOS/sendmail.html" class="sidebar-link">sendmail</a></li><li><a href="/CentOS/dns_server.html" class="sidebar-link">DNS Sever</a></li><li><a href="/CentOS/ftp_server.html" class="sidebar-link">FTP Sever</a></li><li><a href="/CentOS/nfs_server.html" class="sidebar-link">NFS Server</a></li><li><a href="/CentOS/ntp_server.html" class="sidebar-link">NTP Sever</a></li><li><a href="/CentOS/lsyncd.html" class="sidebar-link">lsyncd</a></li><li><a href="/CentOS/kvm_virtulization_deploy.html" class="sidebar-link">KVM</a></li><li><a href="/CentOS/vmware_extend_disk.html" class="sidebar-link">VMware虚拟机扩展磁盘容量</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Docker</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Docker/docker_app.html" class="sidebar-link">Docker应用</a></li><li><a href="/Docker/docker_compose_app.html" class="sidebar-link">Docker-Compose应用</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Nginx</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Nginx/" class="sidebar-link">介绍</a></li><li><a href="/Nginx/nginx_install.html" class="sidebar-link">安装</a></li><li><a href="/Nginx/nginx_config_files.html" class="sidebar-link">配置文件</a></li><li><a href="/Nginx/nginx_proxy.html" class="sidebar-link">反向代理</a></li><li><a href="/Nginx/nginx_max_clients.html" class="sidebar-link">并发数</a></li><li><a href="/Nginx/linux_optimization_for_nginx.html" class="sidebar-link">内核调优</a></li><li><a href="/Nginx/nginx_php_fpm.html" class="sidebar-link">使用PHP-FPM</a></li><li><a href="/Nginx/keepalived_nginx.html" class="sidebar-link">Keepalived + Nginx</a></li><li><a href="/Nginx/configs.html" class="sidebar-link">常用配置</a></li><li><a href="/Nginx/nginx_log_scripts.html" class="sidebar-link">nginx日志分析</a></li><li><a href="/Nginx/http_code.html" class="sidebar-link">HTTP状态码</a></li><li><a href="/Nginx/error_handle.html" class="sidebar-link">常见错误处理</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>MySQL</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/MySQL/" class="sidebar-link">介绍</a></li><li><a href="/MySQL/mysql_installation.html" class="sidebar-link">安装</a></li><li><a href="/MySQL/variables.html" class="sidebar-link">参数</a></li><li><a href="/MySQL/command.html" class="sidebar-link">命令</a></li><li><a href="/MySQL/sql.html" class="sidebar-link">SQL</a></li><li><a href="/MySQL/mysql_scripts.html" class="sidebar-link">脚本</a></li><li><a href="/MySQL/log.html" class="sidebar-link">日志分类</a></li><li><a href="/MySQL/reset_password.html" class="sidebar-link">重置密码</a></li><li><a href="/MySQL/backup.html" class="sidebar-link">备份与恢复</a></li><li><a href="/MySQL/duplication.html" class="sidebar-link">主从复制</a></li><li><a href="/MySQL/optimization.html" class="sidebar-link">运行环境优化</a></li><li><a href="/MySQL/tools.html" class="sidebar-link">实时监控工具</a></li><li><a href="/MySQL/error_code.html" class="sidebar-link">常见错误代码</a></li><li><a href="/MySQL/errors.html" class="sidebar-link">错误处理</a></li><li><a href="/MySQL/innodb.html" class="sidebar-link">InnoDB特性</a></li><li><a href="/MySQL/duplication_case.html" class="sidebar-link">迁移案例</a></li><li><a href="/MySQL/mysql_innodb_cluster.html" class="sidebar-link">MySQL innodb cluster</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Python</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Python/install_python.html" class="sidebar-link">安装</a></li><li><a href="/Python/django_deployment.html" class="sidebar-link">Django项目部署</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Others</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Others/ffmpeg.html" class="sidebar-link">ffmpeg</a></li><li><a href="/Others/mac_tips.html" class="sidebar-link">Mac技巧</a></li><li><a href="/Others/raid_level.html" class="sidebar-link">Raid级别</a></li><li><a href="/Others/servers.html" class="sidebar-link">服务器规划</a></li><li><a href="/Others/memcached.html" class="sidebar-link">Memcached基础</a></li><li><a href="/Others/tomcat_deploy.html" class="sidebar-link">Tomcat部署</a></li><li><a href="/Others/tcp_handshake.html" class="sidebar-link">TCP三次握手四次挥手</a></li><li><a href="/Others/aria2_filebrowser.html" class="sidebar-link">Aria2 离线下载</a></li><li><a href="/Others/word_page_num.html" class="sidebar-link">Word页码编排</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="系统常用配置"><a href="#系统常用配置" class="header-anchor">#</a> 系统常用配置</h1> <h2 id="创建sudo用户"><a href="#创建sudo用户" class="header-anchor">#</a> 创建sudo用户</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">useradd</span> nginx
<span class="token builtin class-name">echo</span> PASSWORD <span class="token operator">|</span> <span class="token function">passwd</span> <span class="token parameter variable">--stdin</span> nginx
<span class="token function">usermod</span> <span class="token parameter variable">-G</span> wheel nginx
</code></pre></div><h2 id="vi别名"><a href="#vi别名" class="header-anchor">#</a> vi别名</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;alias vi='vim'&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/profile
<span class="token builtin class-name">source</span> /etc/profile
</code></pre></div><h2 id="关闭ipv6"><a href="#关闭ipv6" class="header-anchor">#</a> 关闭ipv6</h2> <h3 id="内核参数方式"><a href="#内核参数方式" class="header-anchor">#</a> 内核参数方式</h3> <p>通过配置内核参数关闭 <code>ipv6</code> ，配置完成之后需要重启系统生效</p> <p><strong>CentOS6</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">bash</span> <span class="token parameter variable">-c</span> <span class="token string">'echo &quot;options ipv6 disable=1&quot; &gt; /etc/modprobe.d/disable-ipv6.conf'</span>
<span class="token function">chkconfig</span> ip6tables off
<span class="token function">shutdown</span> <span class="token parameter variable">-r</span> now
</code></pre></div><p>编辑 <code>/boot/grub/grub.conf</code> 文件，在内核启动参数后面追加 <code>ipv6.disable=1</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code>kernel /vmlinuz-2.6.32-431.el6.x86_64 ro <span class="token assign-left variable">root</span><span class="token operator">=</span>UUID<span class="token operator">=</span>2cccbdae-d43f-4109-9679-e4ab6c32afde rd_NO_LUKS rd_NO_LVM <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span>en_US.UTF-8 rd_NO_MD <span class="token assign-left variable">SYSFONT</span><span class="token operator">=</span>latarcyrheb-sun16 <span class="token assign-left variable">crashkernel</span><span class="token operator">=</span>auto  <span class="token assign-left variable">KEYBOARDTYPE</span><span class="token operator">=</span>pc <span class="token assign-left variable">KEYTABLE</span><span class="token operator">=</span>us rd_NO_DM rhgb quiet <span class="token assign-left variable">ipv6.disable</span><span class="token operator">=</span><span class="token number">1</span>
</code></pre></div><p>重启系统</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">shutdown</span> <span class="token parameter variable">-r</span> now
</code></pre></div><p><strong>CentOS7</strong></p> <p>编辑 <code>/etc/default/grub</code> 文件，修改 <code>GRUB_CMDLINE_LINUX</code> 选项，添加 <code>ipv6.disable=1</code> 参数</p> <div class="language-bash extra-class"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br></div><pre class="language-bash"><code><span class="token assign-left variable">GRUB_TIMEOUT</span><span class="token operator">=</span><span class="token number">5</span>
<span class="token assign-left variable">GRUB_DEFAULT</span><span class="token operator">=</span>saved
<span class="token assign-left variable">GRUB_DISABLE_SUBMENU</span><span class="token operator">=</span>true
<span class="token assign-left variable">GRUB_TERMINAL_OUTPUT</span><span class="token operator">=</span><span class="token string">&quot;console&quot;</span>
<span class="token assign-left variable">GRUB_CMDLINE_LINUX</span><span class="token operator">=</span><span class="token string">&quot;ipv6.disable=1 crashkernel=auto rhgb quiet&quot;</span>
<span class="token assign-left variable">GRUB_DISABLE_RECOVERY</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span>
</code></pre></div><p>生成配置文件后，重启系统</p> <div class="language-bash extra-class"><pre class="language-bash"><code>grub2-mkconfig <span class="token parameter variable">-o</span> /boot/grub2/grub.cfg
<span class="token function">shutdown</span> <span class="token parameter variable">-r</span> now
</code></pre></div><h3 id="sysctl方式"><a href="#sysctl方式" class="header-anchor">#</a> sysctl方式</h3> <p>编辑 <code>/etc/sysctl.conf</code> 文件，添加如下配置</p> <div class="language-bash extra-class"><pre class="language-bash"><code>net.ipv6.conf.all.disable_ipv6 <span class="token operator">=</span> <span class="token number">1</span>
net.ipv6.conf.default.disable_ipv6 <span class="token operator">=</span> <span class="token number">1</span>
</code></pre></div><p>生效配置</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">sysctl</span> <span class="token parameter variable">-p</span>
</code></pre></div><p>其中 <code>net.ipv6.conf.all.disable_ipv6</code> 表示针对所有网卡，如果希望某一个网卡禁用，可以指定网卡 <code>net.ipv6.conf.eth0.disable_ipv6 = 1</code> 。这种修改方式不需要重启系统即可生效。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>关闭 <code>ipv6</code> 以后，可能会导致有些使用 <code>ipv6</code> 的应用和服务出现错误，例如 <code>MySQL</code> <code>ssh</code> <code>vsftpd</code> 等，需要在其配置文件中禁用 <code>ipv6</code> 选项，而启用 <code>ipv4</code> ，如 <code>vsftpd</code> 中可能需要 <code>listen=YES</code> <code>listen_ipv6=NO</code></p></div> <h2 id="history计数"><a href="#history计数" class="header-anchor">#</a> history计数</h2> <p>根据实际情况修改 <code>HISTSIZE</code> 值，默认为 <code>1000</code></p> <div class="language-bash extra-class"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br></div><pre class="language-bash"><code><span class="token function">vi</span> /etc/profile
<span class="token assign-left variable"><span class="token environment constant">HISTSIZE</span></span><span class="token operator">=</span><span class="token number">200</span>
<span class="token builtin class-name">source</span> /etc/profile
</code></pre></div><h2 id="ssh设置"><a href="#ssh设置" class="header-anchor">#</a> ssh设置</h2> <h3 id="登录设置"><a href="#登录设置" class="header-anchor">#</a> 登录设置</h3> <p>禁止 <code>root</code> 用户远程登录，不允许空密码，关闭 <code>ssh</code> 反向查询，同时保留一个具有 <code>sudo</code> 权限的普通用户 <code>www</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">'s/#PermitRootLogin yes/PermitRootLogin no'</span> /etc/ssh/sshd_config
<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">'s/#PermitEmptyPasswords no/PermitEmptyPasswords no'</span> /etc/ssh/sshd_config
<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">'s/#UseDNS no/UseDNS no'</span> /etc/ssh/sshd_config
<span class="token function">usermod</span> <span class="token parameter variable">-G</span> wheel www
systemctl restart sshd
</code></pre></div><h3 id="端口设置"><a href="#端口设置" class="header-anchor">#</a> 端口设置</h3> <p>修改 <code>/etc/ssh/sshd_config</code> 文件</p> <div class="language-bash extra-class"><pre class="language-bash"><code>Port <span class="token number">2122</span>
</code></pre></div><p>修改 <code>iptables</code> 规则</p> <div class="language-bash extra-class"><pre class="language-bash"><code>iptables <span class="token parameter variable">-I</span> INPUT <span class="token number">5</span> <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">62122</span> <span class="token parameter variable">-j</span> ACCEPT
iptables-save <span class="token operator">&gt;</span> /etc/sysconfit/iptables
</code></pre></div><p>重启 <code>ssh</code> 服务</p> <div class="language-bash extra-class"><pre class="language-bash"><code>systemctl reload sshd.service <span class="token comment"># systemctl restart sshd.service</span>
</code></pre></div><p>如果启用了 <code>SELinux</code> ，重启服务后 <code>secure</code> 日志中可能会报错</p> <blockquote><p>sshd[1089]: error: Bind to port 2122 on 0.0.0.0 failed: Permission denied</p></blockquote> <p>设置 <code>SELinux</code> 规则，将新端口添加到允许列表</p> <div class="language-bash extra-class"><pre class="language-bash"><code>semanage port <span class="token parameter variable">-a</span> <span class="token parameter variable">-t</span> ssh_port_t <span class="token parameter variable">-p</span> tcp <span class="token number">2122</span>
</code></pre></div><p>通过命令 <code>semanage port -l | grep ssh</code> 查看新的端口允许列表</p> <div class="language-bash extra-class"><pre class="language-bash"><code>ssh_port_t tcp <span class="token number">2122,22</span>
</code></pre></div><h2 id="ssh秘钥登录"><a href="#ssh秘钥登录" class="header-anchor">#</a> ssh秘钥登录</h2> <p>在目标机器上创建秘钥，注意秘钥路径，使用<code>/root/.ssh/test_id_rsa</code>路径时，会默认赋予<code>.ssh</code>目录<code>700</code>权限，否则需要手动修改目录权限<code>chmod -R 700 .ssh</code>，<strong>如果不改，连接<code>ssh</code>会被拒绝</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>ssh-keygen 
Generating public/private rsa key pair.
Enter <span class="token function">file</span> <span class="token keyword">in</span> <span class="token function">which</span> to save the key <span class="token punctuation">(</span>/root/.ssh/id_rsa<span class="token punctuation">)</span>: /root/.ssh/test_id_rsa 
Enter passphrase <span class="token punctuation">(</span>empty <span class="token keyword">for</span> no passphrase<span class="token punctuation">)</span>: 
Enter same passphrase again: 
Your identification has been saved <span class="token keyword">in</span> /root/.ssh/test_id_rsa.
Your public key has been saved <span class="token keyword">in</span> /root/.ssh/test_id_rsa.pub.
The key fingerprint is:
SHA256:4yLpoHd2Vp09wP2s6XXxy/oFDmbMTW1IpMxIFGSlLEY root@p-96b7-neym-0010.novalocal
The key's randomart image is:
+---<span class="token punctuation">[</span>RSA <span class="token number">2048</span><span class="token punctuation">]</span>----+
<span class="token operator">|</span>        Eo*o<span class="token punctuation">..</span>o  <span class="token operator">|</span>
<span class="token operator">|</span>       <span class="token builtin class-name">.</span> + <span class="token operator">=</span> o o <span class="token operator">|</span>
<span class="token operator">|</span>        o.+.+ o o<span class="token operator">|</span>
<span class="token operator">|</span>       <span class="token builtin class-name">.</span> .oo.o <span class="token builtin class-name">.</span> <span class="token operator">|</span>
<span class="token operator">|</span>        S. +*oo. <span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token builtin class-name">.</span> <span class="token punctuation">..</span>.ooooo.o<span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token builtin class-name">.</span> o <span class="token punctuation">..</span>.    +o +<span class="token operator">|</span>
<span class="token operator">|</span> <span class="token punctuation">..</span>oo.o.    o<span class="token punctuation">..</span>.o<span class="token operator">|</span>
<span class="token operator">|</span><span class="token punctuation">..</span> o.o     <span class="token punctuation">..</span>.o+ <span class="token operator">|</span>
+----<span class="token punctuation">[</span>SHA256<span class="token punctuation">]</span>-----+
</code></pre></div><p>拷贝公钥<code>test_id_rsa.pub</code>到<code>authorized_keys</code>中，修改权限<code>chmod 600 authorized_keys</code></p> <p>如果没有文件，直接创建后再修改权限</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cat</span> test_id_rsa.pub <span class="token operator">&gt;</span> authorized_keys
</code></pre></div><p>报错私钥<code>test_id_rsa</code>到本地，添加到<code>ssh</code>客户端连接即可，或者使用命令连接</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">ssh</span> <span class="token parameter variable">-i</span> test_id_rsa root@ip
</code></pre></div><h2 id="升级ssh"><a href="#升级ssh" class="header-anchor">#</a> 升级ssh</h2> <h3 id="下载最新版ssh"><a href="#下载最新版ssh" class="header-anchor">#</a> 下载最新版ssh</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">wget</span> https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-8.9p1.tar.gz
<span class="token function">tar</span> xf openssh-8.9p1.tar.gz
<span class="token builtin class-name">cd</span> openssh-8.9p1/
</code></pre></div><h3 id="删除旧版ssh"><a href="#删除旧版ssh" class="header-anchor">#</a> 删除旧版ssh</h3> <p>注意卸载时的依赖，尽量在系统初始化时升级ssh</p> <div class="language-bash extra-class"><pre class="language-bash"><code>yum remove openssh
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> /etc/ssh/*
</code></pre></div><h3 id="编译新版ssh"><a href="#编译新版ssh" class="header-anchor">#</a> 编译新版ssh</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>yum <span class="token parameter variable">-y</span> <span class="token function">install</span> pam-devel
./configure <span class="token punctuation">\</span>
<span class="token parameter variable">--prefix</span><span class="token operator">=</span>/usr/ <span class="token punctuation">\</span>
<span class="token parameter variable">--sysconfdir</span><span class="token operator">=</span>/etc/ssh <span class="token punctuation">\</span>
--with-openssl-includes<span class="token operator">=</span>/usr/local/ssl/include <span class="token punctuation">\</span>
--with-ssl-dir<span class="token operator">=</span>/usr/local/ssl <span class="token punctuation">\</span>
--with-zlib <span class="token punctuation">\</span>
--with-md5-passwords <span class="token punctuation">\</span>
--with-pam
<span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span>
</code></pre></div><h3 id="配置sshd服务"><a href="#配置sshd服务" class="header-anchor">#</a> 配置sshd服务</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">pwd</span>
openssh-8.9p1
<span class="token function">cp</span> <span class="token parameter variable">-a</span> contrib/redhat/sshd.init /etc/init.d/sshd
<span class="token function">cp</span> <span class="token parameter variable">-a</span> contrib/redhat/sshd.pam /etc/pam.d/sshd.pam
<span class="token function">chmod</span> +x /etc/init.d/sshd
<span class="token function">chkconfig</span> <span class="token parameter variable">--add</span> sshd
<span class="token function">chkconfig</span> sshd on
<span class="token function">service</span> sshd start
</code></pre></div><p>配置好以后可以使用<code>systemctl</code>管理<code>sshd</code></p> <h3 id="查看ssh"><a href="#查看ssh" class="header-anchor">#</a> 查看ssh</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">ssh</span> <span class="token parameter variable">-V</span>
OpenSSH_8.9p1, OpenSSL <span class="token number">1.0</span>.2k-fips  <span class="token number">26</span> Jan <span class="token number">2017</span>

systemctl status sshd
</code></pre></div><h3 id="升级后配置"><a href="#升级后配置" class="header-anchor">#</a> 升级后配置</h3> <p>根据情况配置<code>/etc/ssh/sshd_config</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code>PasswordAuthentication <span class="token function">yes</span>
PubkeyAuthentication <span class="token function">yes</span>
PermitRootLogin <span class="token function">yes</span>
</code></pre></div><h2 id="修改时区"><a href="#修改时区" class="header-anchor">#</a> 修改时区</h2> <p><code>CentOS6</code> 的时区文件是 <code>/etc/localtime</code> ，而 <code>7</code> 的 <code>/etc/localtime</code> 是一个链接</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># CentOS 7</span>

$ ll /etc/localtime
lrwxrwxrwx <span class="token number">1</span> root root <span class="token number">33</span> Oct <span class="token number">12</span> <span class="token number">11</span>:01 /etc/localtime -<span class="token operator">&gt;</span> <span class="token punctuation">..</span>/usr/share/zoneinfo/Asia/Shanghai
</code></pre></div><p><code>CentOS7</code> 如果采用直接 <code>cp</code> 的方法修改系统时区，那么就会把它所链接的文件修改掉，例如把美国的时区文件内容修改成了上海的时区内容，有可能会导致有些程序在读取系统时区的时候发生错误，因此正确的修改方法是：</p> <p><strong>CentOS6</strong></p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">cp</span> /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
</code></pre></div><p><strong>CentOS7</strong></p> <p>最好的办法是使用 <code>timedatectl</code> 命令</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">sudo</span> timedatectl list-timezones <span class="token operator">|</span><span class="token function">grep</span> Shanghai <span class="token comment">#查找中国时区的完整名称</span>
Asia/Shanghai
$ <span class="token function">sudo</span> timedatectl set-timezone Asia/Shanghai <span class="token comment">#其他时区以此类推</span>
</code></pre></div><h2 id="时间同步"><a href="#时间同步" class="header-anchor">#</a> 时间同步</h2> <p>安装<code>ntpd</code>和<code>ntpdate</code></p> <div class="language-sh extra-class"><pre class="language-sh"><code>yum <span class="token parameter variable">-y</span> <span class="token function">install</span> ntp
</code></pre></div><p>采用阿里云的时间服务器配置<code>/etc/ntp.conf</code></p> <div class="language-sh extra-class"><pre class="language-sh"><code>driftfile  /var/lib/ntp/drift
pidfile   /var/run/ntpd.pid
logfile /var/log/ntp.log
restrict    default kod nomodify notrap nopeer noquery
restrict <span class="token parameter variable">-6</span> default kod nomodify notrap nopeer noquery
restrict <span class="token number">127.0</span>.0.1
server <span class="token number">127.127</span>.1.0
fudge  <span class="token number">127.127</span>.1.0 stratum <span class="token number">10</span>
server ntp.aliyun.com iburst minpoll <span class="token number">4</span> maxpoll <span class="token number">10</span>
restrict ntp.aliyun.com nomodify notrap nopeer noquery
</code></pre></div><p>启动<code>ntpd</code>服务</p> <div class="language-sh extra-class"><pre class="language-sh"><code>systemctl <span class="token builtin class-name">enable</span> ntpd <span class="token operator">&amp;&amp;</span> systemctl start ntpd
</code></pre></div><p>如果本机时间和标准时间相差较大，可以使用<code>ntpdate</code>命令立刻更新时间</p> <div class="language-sh extra-class"><pre class="language-sh"><code>ntpdate <span class="token parameter variable">-u</span> ntp.aliyun.com
</code></pre></div><p>其中<code>ntpd</code>服务是用来微调本机时间与标准时间直接的微小差距，如果时间相差较大，<code>ntpd</code>无法自动完成校准</p> <h2 id="设置启动内核"><a href="#设置启动内核" class="header-anchor">#</a> 设置启动内核</h2> <p>以下操作需要 <code>root</code> 权限</p> <h3 id="查看当前系统内核列表"><a href="#查看当前系统内核列表" class="header-anchor">#</a> 查看当前系统内核列表</h3> <div class="language-bash extra-class"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br></div><pre class="language-bash"><code><span class="token function">awk</span> -F<span class="token punctuation">\</span>' <span class="token string">'$1==&quot;menuentry &quot; {print i++ &quot; : &quot; $2}'</span> /etc/grub2.cfg
<span class="token number">0</span> <span class="token builtin class-name">:</span> CentOS Linux <span class="token punctuation">(</span><span class="token number">3.10</span>.0-693.2.2.el7.x86_64<span class="token punctuation">)</span> <span class="token number">7</span> <span class="token punctuation">(</span>Core<span class="token punctuation">)</span>
<span class="token number">1</span> <span class="token builtin class-name">:</span> CentOS Linux, with Linux <span class="token number">3.10</span>.0-123.el7.x86_64
<span class="token number">2</span> <span class="token builtin class-name">:</span> CentOS Linux, with Linux <span class="token number">0</span>-rescue-25f6666d21994946b4f2527b8f48d8c2
</code></pre></div><h3 id="查看默认启动的内核"><a href="#查看默认启动的内核" class="header-anchor">#</a> 查看默认启动的内核</h3> <div class="language-bash extra-class"><div class="highlight-lines"><div class="highlighted"> </div><br><br></div><pre class="language-bash"><code>grub2-editenv list
<span class="token assign-left variable">saved_entry</span><span class="token operator">=</span>CentOS Linux <span class="token punctuation">(</span><span class="token number">3.10</span>.0-693.2.2.el7.x86_64<span class="token punctuation">)</span> <span class="token number">7</span> <span class="token punctuation">(</span>Core<span class="token punctuation">)</span>
</code></pre></div><h3 id="设置默认启动的内核"><a href="#设置默认启动的内核" class="header-anchor">#</a> 设置默认启动的内核</h3> <p>根据上面列出的内核列表编号设置</p> <p><strong>方法一</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>grub2-set-default <span class="token number">2</span>
</code></pre></div><p><strong>方法二</strong></p> <div class="language-bash extra-class"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br></div><pre class="language-bash"><code><span class="token function">vi</span> /etc/default/grub
<span class="token assign-left variable">GRUB_DEFAULT</span><span class="token operator">=</span><span class="token number">2</span>
grub2-mkconfig <span class="token parameter variable">-o</span> /boot/grub2/grub.cfg
</code></pre></div><h2 id="恢复root口令"><a href="#恢复root口令" class="header-anchor">#</a> 恢复root口令</h2> <h3 id="centos6"><a href="#centos6" class="header-anchor">#</a> CentOS6</h3> <p>在引导菜单倒计时界面按任意键，进入 <code>grub</code> 引导菜单，定位到 <code>kernel</code> 行，按 <code>e</code> 键进入内核引导参数编辑界面，在末尾追加 <code>single</code> （也可以填数字1），回车返回上级界面，按 <code>b</code> 键开始引导当前内核，成功引导到单用户模式下，直接执行 <code>passwd</code> 命令重置 <code>root</code> 密码，然后按 <code>Ctrl+d</code> 或执行 <code>exit</code> 命令</p> <h3 id="centos7"><a href="#centos7" class="header-anchor">#</a> CentOS7</h3> <p>在引导菜单倒计时界面按 <code>e</code> 键，进入 <code>grub</code> 引导参数编辑界面，定位到 <code>linux16</code> 所在行的末尾，追加 <code>rd.break</code> ，也可以追加 <code>systemd.unit=emergency.target(或systemd.unit=rescue.target) init=/sysroot/bin/sh</code> ，按 <code>Ctrl+x</code> 引导，最后 <code>chroot</code> 到 <code>/sysroot</code> 下修改 <code>root</code> 口令</p> <div class="language-bash extra-class"><pre class="language-bash"><code>switch_root:/<span class="token comment"># mount -o remount,rw /sysroot</span>
switch_root:/<span class="token comment"># chroot /sysroot</span>
sh-4.2<span class="token comment"># passwd</span>
sh-4.2<span class="token comment"># touch /.autorelabel #告诉Linux在下次引导时给所有文件重新赋予selinux标签</span>
sh-4.2<span class="token comment"># exit</span>
switch_root:/<span class="token comment"># exit</span>
</code></pre></div><h2 id="设置网卡子接口"><a href="#设置网卡子接口" class="header-anchor">#</a> 设置网卡子接口</h2> <p>以下操作需要 <code>root</code> 权限，以 <code>eth0</code> 为例</p> <p><strong>临时生效</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">ip</span> addr <span class="token function">add</span> <span class="token number">10.1</span>.1.1/24 dev eth0 lable eth0:0
</code></pre></div><p><strong>永久生效</strong></p> <p>在 <code>/etc/sysconfig/network-scripts/</code> 中拷贝一个 <code>ifcfg-eth0</code> 为 <code>ifcfg-eth0:0</code> ，修改其中的配置信息，去掉默认网关，其他不变</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">IPADDR</span><span class="token operator">=</span><span class="token number">10.1</span>.1.1
<span class="token assign-left variable">PREFIX</span><span class="token operator">=</span><span class="token number">24</span>
<span class="token comment"># GATEWAY=10.1.1.254</span>
</code></pre></div><p>重启网络服务</p> <div class="language-bash extra-class"><pre class="language-bash"><code>systemctl restart network.services <span class="token comment"># service network restart (CentOS6)</span>
</code></pre></div><h2 id="最大文件打开数"><a href="#最大文件打开数" class="header-anchor">#</a> 最大文件打开数</h2> <p>针对 <code>www</code> 用户设置，也可以使用 <code>*</code> 对所有用户设置，重启生效。这里设置的值不能大于 <code>file-max</code> ，编辑 <code>/etc/security/limits.d/20-nproc.conf</code> 文件，添加如下配置</p> <div class="language-bash extra-class"><pre class="language-bash"><code>www   soft    nproc   <span class="token number">65535</span>
www   hard    nproc   <span class="token number">65535</span>
www   soft    nofile  <span class="token number">65535</span>
www   hard    nofile  <span class="token number">65535</span>
</code></pre></div><p>通过命令 <code>cat /proc/&lt;pid&gt;/limits | grep &quot;Max open files&quot;</code> 查看 <code>www</code> 用户下运行进程的 <code>limits</code> 查看打开文件数限制</p> <div class="language-bash extra-class"><pre class="language-bash"><code>Max <span class="token function">open</span> files            <span class="token number">65535</span>                <span class="token number">65535</span>                files
</code></pre></div><h2 id="命令行提示符颜色"><a href="#命令行提示符颜色" class="header-anchor">#</a> 命令行提示符颜色</h2> <p>默认命令行提示符是白色，配置成彩色有利于快速定位命令行提示符，退出后重新登录生效</p> <p><strong>全局设置</strong></p> <p>在 <code>/etc/bashrc</code> 中找到下面一行，注释后修改</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#  [ &quot;$PS1&quot; = &quot;\\s-\\v\\\$ &quot; ] &amp;&amp; PS1=&quot;[\u@\h \W]\\$ &quot;</span>
  <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token environment constant">$PS1</span>&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;<span class="token entity" title="\\">\\</span>s-<span class="token entity" title="\\">\\</span>v<span class="token entity" title="\\">\\</span>\$ &quot;</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token assign-left variable"><span class="token environment constant">PS1</span></span><span class="token operator">=</span><span class="token string">&quot;\[<span class="token entity" title="\e">\e</span>[35m\][\u@\h \W]<span class="token entity" title="\\">\\</span>$\[<span class="token entity" title="\e">\e</span>[0m\] &quot;</span>
</code></pre></div><p><strong>普通用户设置</strong></p> <p>在 <code>~/.bashrc</code> 中添加一行</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable"><span class="token environment constant">PS1</span></span><span class="token operator">=</span><span class="token string">&quot;\[<span class="token entity" title="\e">\e</span>[35m\][\u@\h \W]<span class="token entity" title="\\">\\</span>$\[<span class="token entity" title="\e">\e</span>[0m\] &quot;</span>
</code></pre></div><p>or</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PS1</span></span><span class="token operator">=</span><span class="token string">'\n\e[1;37m[\e[m\e[1;35m\u\e[m\e[1;36m@\e[m\e[1;37m\H\e[m \e[1;33m\A\e[m \w\e[m\e[1;37m]\e[m\e[1;36m\e[m\n\$ '</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span>en_US.UTF-8
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">LC_ALL</span></span><span class="token operator">=</span>en_US.UTF-8
</code></pre></div><p>新版 <code>Debian</code> 风格</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable"><span class="token environment constant">PS1</span></span><span class="token operator">=</span><span class="token string">&quot;\[<span class="token entity" title="\e">\e</span>]0;\u@\h: \w<span class="token entity" title="\a">\a</span>\]\[<span class="token entity" title="\033">\033</span>[01;32m\]\u@\h\[<span class="token entity" title="\033">\033</span>[00m\]:\[<span class="token entity" title="\033">\033</span>[01;34m\]\w\[<span class="token entity" title="\033">\033</span>[00m\]# &quot;</span>
</code></pre></div><p><strong>颜色代码</strong></p> <table><thead><tr><th style="text-align:center;">Front</th> <th style="text-align:center;">Background</th> <th style="text-align:center;">color</th></tr></thead> <tbody><tr><td style="text-align:center;">30</td> <td style="text-align:center;">40</td> <td style="text-align:center;">黑色</td></tr> <tr><td style="text-align:center;">31</td> <td style="text-align:center;">41</td> <td style="text-align:center;">红色</td></tr> <tr><td style="text-align:center;">32</td> <td style="text-align:center;">42</td> <td style="text-align:center;">绿色</td></tr> <tr><td style="text-align:center;">33</td> <td style="text-align:center;">43</td> <td style="text-align:center;">黄色</td></tr> <tr><td style="text-align:center;">34</td> <td style="text-align:center;">44</td> <td style="text-align:center;">蓝色</td></tr> <tr><td style="text-align:center;">35</td> <td style="text-align:center;">45</td> <td style="text-align:center;">紫红色</td></tr> <tr><td style="text-align:center;">36</td> <td style="text-align:center;">46</td> <td style="text-align:center;">青蓝色</td></tr> <tr><td style="text-align:center;">37</td> <td style="text-align:center;">47</td> <td style="text-align:center;">白色</td></tr></tbody></table> <h2 id="适当减少不必要的磁盘i-o"><a href="#适当减少不必要的磁盘i-o" class="header-anchor">#</a> 适当减少不必要的磁盘I/O</h2> <p>有些线上业务可能不必要记录文件访问时间 <code>atime</code> ，例如 <code>WEB</code> 应用的静态资源，因此可以在对应的磁盘分区上关闭记录文件访问时间以减少磁盘 <code>I/O</code> ，在 <code>/etc/fstab</code> 中修改挂载参数</p> <div class="language-bash extra-class"><pre class="language-bash"><code>/dev/sda2   /home   xfs     noatime,nodiratime <span class="token number">0</span> <span class="token number">0</span>
</code></pre></div><h2 id="nologin用户配置家目录"><a href="#nologin用户配置家目录" class="header-anchor">#</a> nologin用户配置家目录</h2> <p>有时在系统中安装软件时会创建一个专用用户，例如 <code>mysql</code> ，但是并没有为它设置家目录。但是后来又需要 <code>mysql</code> 作为一个普通用户来使用。</p> <h3 id="配置方法"><a href="#配置方法" class="header-anchor">#</a> 配置方法</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">usermod</span> <span class="token parameter variable">-s</span> /bin/bash mysql
<span class="token function">mkdir</span> /home/mysql
<span class="token function">chmod</span> <span class="token number">700</span> /home/mysql
<span class="token function">cp</span> <span class="token parameter variable">-a</span> /etc/skel/. /home/mysql
<span class="token function">chown</span> <span class="token parameter variable">-R</span> mysql:mysql /home/mysql
<span class="token function">chmod</span> <span class="token number">755</span> /home
<span class="token function">su</span> - mysql
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>如果没有创建家目录或者没有登陆 <code>shell</code> ，可能会出现以下报错：</p> <p>su warning cannot change directory to /home/mysql , no such file or directory</p></div> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>权限问题，可能出现以下报错：</p> <p>su: warning: cannot change directory to /home/mysql: Permission denied</p> <p>如果确保了 <code>/home/mysql</code> 目录权限和用户组完全正确，那么就是 <code>/home</code> 目录的问题，它的权限应为 <code>755</code> ，用户和组都应是 <code>root</code> ，如果不是，同样会报 <code>Permission denied</code></p></div> <h2 id="常用命令"><a href="#常用命令" class="header-anchor">#</a> 常用命令</h2> <p>主机名及相关信息</p> <div class="language-bash extra-class"><pre class="language-bash"><code>hostnamectl
</code></pre></div><p>查看系统版本</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cat</span> /etc/system-release <span class="token comment"># cat /etc/centos-release</span>
</code></pre></div><p>查看机器型号</p> <div class="language-bash extra-class"><pre class="language-bash"><code>dmidecode <span class="token operator">|</span> <span class="token function">grep</span> Product
</code></pre></div><p>查看内存物理插槽使用情况</p> <div class="language-bash extra-class"><pre class="language-bash"><code>dmidecode <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-A5</span> <span class="token string">&quot;Memory Device&quot;</span> <span class="token operator">|</span> <span class="token function">grep</span> Size <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> Range
</code></pre></div><p>查看所有磁盘</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">fdisk</span> <span class="token parameter variable">-l</span>
</code></pre></div><p>查看已挂载磁盘空间使用情况</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">df</span> <span class="token parameter variable">-h</span>
</code></pre></div><p>查看磁盘挂载情况</p> <div class="language-bash extra-class"><pre class="language-bash"><code>findmnt
</code></pre></div><p>查看CPU详细信息</p> <div class="language-bash extra-class"><pre class="language-bash"><code>lscpu
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/CentOS/boot_order.html" class="prev">
        启动顺序
      </a></span> <span class="next"><a href="/CentOS/yum.html">
        yum命令
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.6ea617b8.js" defer></script><script src="/assets/js/2.6e381248.js" defer></script><script src="/assets/js/27.164897ca.js" defer></script>
  </body>
</html>
