<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>命令 | 个人文档库</title>
    <meta name="generator" content="VuePress 1.9.8">
    
    <meta name="description" content="运维知识文档">
    
    <link rel="preload" href="/assets/css/0.styles.86682925.css" as="style"><link rel="preload" href="/assets/js/app.6ea617b8.js" as="script"><link rel="preload" href="/assets/js/2.6e381248.js" as="script"><link rel="preload" href="/assets/js/35.1d02fd3c.js" as="script"><link rel="prefetch" href="/assets/js/10.dd27a2bb.js"><link rel="prefetch" href="/assets/js/11.ec440828.js"><link rel="prefetch" href="/assets/js/12.c67fbef0.js"><link rel="prefetch" href="/assets/js/13.a53b31f6.js"><link rel="prefetch" href="/assets/js/14.fac02fcf.js"><link rel="prefetch" href="/assets/js/15.366e462e.js"><link rel="prefetch" href="/assets/js/16.ae609dff.js"><link rel="prefetch" href="/assets/js/17.7976f036.js"><link rel="prefetch" href="/assets/js/18.3f258419.js"><link rel="prefetch" href="/assets/js/19.0ad2626e.js"><link rel="prefetch" href="/assets/js/20.bdf3dbe2.js"><link rel="prefetch" href="/assets/js/21.04180477.js"><link rel="prefetch" href="/assets/js/22.f4cf519a.js"><link rel="prefetch" href="/assets/js/23.9e5b52cd.js"><link rel="prefetch" href="/assets/js/24.b0159ef8.js"><link rel="prefetch" href="/assets/js/25.e38d986a.js"><link rel="prefetch" href="/assets/js/26.b44e8359.js"><link rel="prefetch" href="/assets/js/27.164897ca.js"><link rel="prefetch" href="/assets/js/28.30c3dcb6.js"><link rel="prefetch" href="/assets/js/29.0ea1763d.js"><link rel="prefetch" href="/assets/js/3.87c14ff3.js"><link rel="prefetch" href="/assets/js/30.b6b9f227.js"><link rel="prefetch" href="/assets/js/31.d7d6e5fa.js"><link rel="prefetch" href="/assets/js/32.a71c64f7.js"><link rel="prefetch" href="/assets/js/33.6e421306.js"><link rel="prefetch" href="/assets/js/34.0f46b74a.js"><link rel="prefetch" href="/assets/js/36.fc5cc9cb.js"><link rel="prefetch" href="/assets/js/37.af7e5661.js"><link rel="prefetch" href="/assets/js/38.cdd11312.js"><link rel="prefetch" href="/assets/js/39.30bb1d36.js"><link rel="prefetch" href="/assets/js/4.91553c08.js"><link rel="prefetch" href="/assets/js/40.c4740fee.js"><link rel="prefetch" href="/assets/js/41.37a38f62.js"><link rel="prefetch" href="/assets/js/42.df5bcbd7.js"><link rel="prefetch" href="/assets/js/43.0c0ab294.js"><link rel="prefetch" href="/assets/js/44.1dcaa2ac.js"><link rel="prefetch" href="/assets/js/45.c3b4bbca.js"><link rel="prefetch" href="/assets/js/46.7659ce01.js"><link rel="prefetch" href="/assets/js/47.d6eb360d.js"><link rel="prefetch" href="/assets/js/48.ca9d607b.js"><link rel="prefetch" href="/assets/js/49.8c09eac0.js"><link rel="prefetch" href="/assets/js/5.6d5ca1ce.js"><link rel="prefetch" href="/assets/js/50.3694eddb.js"><link rel="prefetch" href="/assets/js/51.0868c6f4.js"><link rel="prefetch" href="/assets/js/52.513df7cc.js"><link rel="prefetch" href="/assets/js/53.9dcabf12.js"><link rel="prefetch" href="/assets/js/54.70a6c075.js"><link rel="prefetch" href="/assets/js/55.a1d14f80.js"><link rel="prefetch" href="/assets/js/56.7029bd26.js"><link rel="prefetch" href="/assets/js/57.1b116307.js"><link rel="prefetch" href="/assets/js/58.bb74acae.js"><link rel="prefetch" href="/assets/js/59.610e7d4f.js"><link rel="prefetch" href="/assets/js/6.ee71a04b.js"><link rel="prefetch" href="/assets/js/60.98e611f4.js"><link rel="prefetch" href="/assets/js/61.05109453.js"><link rel="prefetch" href="/assets/js/62.f4adfb83.js"><link rel="prefetch" href="/assets/js/63.b63e1591.js"><link rel="prefetch" href="/assets/js/64.1235f2bd.js"><link rel="prefetch" href="/assets/js/65.bfa7cab9.js"><link rel="prefetch" href="/assets/js/66.2574fbb1.js"><link rel="prefetch" href="/assets/js/67.09935f72.js"><link rel="prefetch" href="/assets/js/68.af1ee108.js"><link rel="prefetch" href="/assets/js/69.7a2f9a81.js"><link rel="prefetch" href="/assets/js/7.ed4c5699.js"><link rel="prefetch" href="/assets/js/70.605c490c.js"><link rel="prefetch" href="/assets/js/8.c8b45379.js"><link rel="prefetch" href="/assets/js/9.9d028748.js">
    <link rel="stylesheet" href="/assets/css/0.styles.86682925.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">个人文档库</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="http://www.linuxd.cc/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  HOLA
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/LinuxDiary/scripts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  脚本
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="http://www.linuxd.cc/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  HOLA
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/LinuxDiary/scripts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  脚本
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>CentOS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/CentOS/boot_order.html" class="sidebar-link">启动顺序</a></li><li><a href="/CentOS/system_initialization.html" class="sidebar-link">系统常用配置</a></li><li><a href="/CentOS/yum.html" class="sidebar-link">yum命令</a></li><li><a href="/CentOS/rpm.html" class="sidebar-link">rpm命令</a></li><li><a href="/CentOS/date_command_opstions.html" class="sidebar-link">date命令选项</a></li><li><a href="/CentOS/system_logs.html" class="sidebar-link">系统日志说明</a></li><li><a href="/CentOS/grep_sed_awk.html" class="sidebar-link">grep sed awk</a></li><li><a href="/CentOS/file_descriptor.html" class="sidebar-link">文件描述符</a></li><li><a href="/CentOS/stdin_stdout_stderr.html" class="sidebar-link">输入输出重定向</a></li><li><a href="/CentOS/iptables.html" class="sidebar-link">iptables</a></li><li><a href="/CentOS/sysctl.html" class="sidebar-link">sysctl基本优化</a></li><li><a href="/CentOS/load_balance.html" class="sidebar-link">双网卡绑定和负载均衡</a></li><li><a href="/CentOS/lvm.html" class="sidebar-link">lvm管理</a></li><li><a href="/CentOS/sendmail.html" class="sidebar-link">sendmail</a></li><li><a href="/CentOS/dns_server.html" class="sidebar-link">DNS Sever</a></li><li><a href="/CentOS/ftp_server.html" class="sidebar-link">FTP Sever</a></li><li><a href="/CentOS/nfs_server.html" class="sidebar-link">NFS Server</a></li><li><a href="/CentOS/ntp_server.html" class="sidebar-link">NTP Sever</a></li><li><a href="/CentOS/lsyncd.html" class="sidebar-link">lsyncd</a></li><li><a href="/CentOS/kvm_virtulization_deploy.html" class="sidebar-link">KVM</a></li><li><a href="/CentOS/vmware_extend_disk.html" class="sidebar-link">VMware虚拟机扩展磁盘容量</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Docker</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Docker/docker_app.html" class="sidebar-link">Docker应用</a></li><li><a href="/Docker/docker_compose_app.html" class="sidebar-link">Docker-Compose应用</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Nginx</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Nginx/" class="sidebar-link">介绍</a></li><li><a href="/Nginx/nginx_install.html" class="sidebar-link">安装</a></li><li><a href="/Nginx/nginx_config_files.html" class="sidebar-link">配置文件</a></li><li><a href="/Nginx/nginx_proxy.html" class="sidebar-link">反向代理</a></li><li><a href="/Nginx/nginx_max_clients.html" class="sidebar-link">并发数</a></li><li><a href="/Nginx/linux_optimization_for_nginx.html" class="sidebar-link">内核调优</a></li><li><a href="/Nginx/nginx_php_fpm.html" class="sidebar-link">使用PHP-FPM</a></li><li><a href="/Nginx/keepalived_nginx.html" class="sidebar-link">Keepalived + Nginx</a></li><li><a href="/Nginx/configs.html" class="sidebar-link">常用配置</a></li><li><a href="/Nginx/nginx_log_scripts.html" class="sidebar-link">nginx日志分析</a></li><li><a href="/Nginx/http_code.html" class="sidebar-link">HTTP状态码</a></li><li><a href="/Nginx/error_handle.html" class="sidebar-link">常见错误处理</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>MySQL</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/MySQL/" aria-current="page" class="sidebar-link">介绍</a></li><li><a href="/MySQL/mysql_installation.html" class="sidebar-link">安装</a></li><li><a href="/MySQL/variables.html" class="sidebar-link">参数</a></li><li><a href="/MySQL/command.html" aria-current="page" class="active sidebar-link">命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/MySQL/command.html#mysql" class="sidebar-link">mysql</a></li><li class="sidebar-sub-header"><a href="/MySQL/command.html#mysqladmin" class="sidebar-link">mysqladmin</a></li><li class="sidebar-sub-header"><a href="/MySQL/command.html#mysqlbinlog" class="sidebar-link">mysqlbinlog</a></li><li class="sidebar-sub-header"><a href="/MySQL/command.html#mysqldump" class="sidebar-link">mysqldump</a></li><li class="sidebar-sub-header"><a href="/MySQL/command.html#mysqldumpslow" class="sidebar-link">mysqldumpslow</a></li><li class="sidebar-sub-header"><a href="/MySQL/command.html#mysqld-safe" class="sidebar-link">mysqld_safe</a></li><li class="sidebar-sub-header"><a href="/MySQL/command.html#mysqlshow" class="sidebar-link">mysqlshow</a></li></ul></li><li><a href="/MySQL/sql.html" class="sidebar-link">SQL</a></li><li><a href="/MySQL/mysql_scripts.html" class="sidebar-link">脚本</a></li><li><a href="/MySQL/log.html" class="sidebar-link">日志分类</a></li><li><a href="/MySQL/reset_password.html" class="sidebar-link">重置密码</a></li><li><a href="/MySQL/backup.html" class="sidebar-link">备份与恢复</a></li><li><a href="/MySQL/duplication.html" class="sidebar-link">主从复制</a></li><li><a href="/MySQL/optimization.html" class="sidebar-link">运行环境优化</a></li><li><a href="/MySQL/tools.html" class="sidebar-link">实时监控工具</a></li><li><a href="/MySQL/error_code.html" class="sidebar-link">常见错误代码</a></li><li><a href="/MySQL/errors.html" class="sidebar-link">错误处理</a></li><li><a href="/MySQL/innodb.html" class="sidebar-link">InnoDB特性</a></li><li><a href="/MySQL/duplication_case.html" class="sidebar-link">迁移案例</a></li><li><a href="/MySQL/mysql_innodb_cluster.html" class="sidebar-link">MySQL innodb cluster</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Python</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Python/install_python.html" class="sidebar-link">安装</a></li><li><a href="/Python/django_deployment.html" class="sidebar-link">Django项目部署</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Others</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Others/ffmpeg.html" class="sidebar-link">ffmpeg</a></li><li><a href="/Others/mac_tips.html" class="sidebar-link">Mac技巧</a></li><li><a href="/Others/raid_level.html" class="sidebar-link">Raid级别</a></li><li><a href="/Others/servers.html" class="sidebar-link">服务器规划</a></li><li><a href="/Others/memcached.html" class="sidebar-link">Memcached基础</a></li><li><a href="/Others/tomcat_deploy.html" class="sidebar-link">Tomcat部署</a></li><li><a href="/Others/tcp_handshake.html" class="sidebar-link">TCP三次握手四次挥手</a></li><li><a href="/Others/aria2_filebrowser.html" class="sidebar-link">Aria2 离线下载</a></li><li><a href="/Others/word_page_num.html" class="sidebar-link">Word页码编排</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="命令"><a href="#命令" class="header-anchor">#</a> 命令</h1> <p></p><div class="table-of-contents"><ul><li><a href="#mysql">mysql</a><ul><li><a href="#常用参数">常用参数</a></li><li><a href="#常见用法">常见用法</a></li></ul></li><li><a href="#mysqladmin">mysqladmin</a><ul><li><a href="#常用参数">常用参数</a></li><li><a href="#常用命令">常用命令</a></li><li><a href="#常见用法">常见用法</a></li></ul></li><li><a href="#mysqlbinlog">mysqlbinlog</a><ul><li><a href="#常用参数">常用参数</a></li><li><a href="#常见用法">常见用法</a></li></ul></li><li><a href="#mysqldump">mysqldump</a><ul><li><a href="#常用参数">常用参数</a></li><li><a href="#常见用法">常见用法</a></li></ul></li><li><a href="#mysqldumpslow">mysqldumpslow</a><ul><li><a href="#常用参数">常用参数</a></li><li><a href="#用法">用法</a></li></ul></li><li><a href="#mysqld-safe">mysqld_safe</a><ul><li><a href="#常用参数">常用参数</a></li><li><a href="#常见用法">常见用法</a></li></ul></li><li><a href="#mysqlshow">mysqlshow</a><ul><li><a href="#常用参数">常用参数</a></li><li><a href="#常见用法">常见用法</a></li></ul></li></ul></div><p></p> <h2 id="mysql"><a href="#mysql" class="header-anchor">#</a> mysql</h2> <h3 id="常用参数"><a href="#常用参数" class="header-anchor">#</a> 常用参数</h3> <table><thead><tr><th>选项</th> <th>说明</th></tr></thead> <tbody><tr><td>-h, --host=name</td> <td>Connect to host.</td></tr> <tr><td></td> <td>指定服务器IP或域名(如果数据库服务器开启了域名解析)</td></tr> <tr><td>-P, --port=#</td> <td>Port number to use for connection or 0 for default to, in order of preference, my.cnf, $MYSQL_TCP_PORT,/etc/services, built-in default (3306).</td></tr> <tr><td></td> <td>指定服务器端口，默认是3306。mysql 命令连接数据库时如果不带-P参数，将使用默认值或者 my.cnf 或 /etc/services中$MYSQL_TCP_PORT指定的端口</td></tr> <tr><td>-u, --user=name</td> <td>User for login if not current user.</td></tr> <tr><td></td> <td>指定登陆数据库服务器的用户，默认是root</td></tr> <tr><td>-p, --password[=name]</td> <td>Password to use when connecting to server. If password is not given it is asked from the tty.</td></tr> <tr><td></td> <td>指定登陆数据库服务器的密码，如果不带值，将在tty中按提示输入密码</td></tr> <tr><td>-D, --database=name</td> <td>Database to use.</td></tr> <tr><td></td> <td>指定登陆后立即 USE 的数据库名</td></tr> <tr><td>--default-character-set=name</td> <td>Set the default character set.</td></tr> <tr><td></td> <td>指定当前会话的字符集，即指定了当前会话中 SHOW VARIABLES LIKE 'cha%'里character_set_client、character_set_connection、character_set_results的值，退出即失效，相当于 SET NAMES latin1 临时生效</td></tr> <tr><td>-e, --execute=name</td> <td>Execute command and quit. (Disables --force and historyfile.)</td></tr> <tr><td></td> <td>直接执行SQL语句，执行完毕立即退出MySQL客户端。执行的结果将直接输出到bash的stdout，可以用grep等命令对结果进行处理</td></tr> <tr><td>--init-command=name</td> <td>SQL Command to execute when connecting to MySQL server.Will automatically be re-executed when reconnecting.</td></tr> <tr><td></td> <td>连接MySQL服务器之后立即执行的SQL语句，类似于开机启动脚本</td></tr> <tr><td>--local-infile</td> <td>Enable/disable LOAD DATA LOCAL INFILE.</td></tr> <tr><td></td> <td>当前会话中允许使用LOAD DATA LOCAL INFILE</td></tr> <tr><td>--prompt=name</td> <td>Set the mysql prompt to this value.</td></tr> <tr><td></td> <td>指定当前会话的命令提示符，一般会用--prompt='\u@\h \d&gt;'只在当前会话生效，退出失效如果想要永久生效，在客户端操作系统的my.cnf中的[mysql]中添加prompt='\u@\h \d&gt;' 选项，'\' 是为了防止转义注意：在服务端修改的只能生效于服务端中的mysql客户端</td></tr> <tr><td>-S, --socket=name</td> <td>The socket file to use for connection.</td></tr> <tr><td></td> <td>指定连接的socket。在多实例服务端中连接数据库时必须指定，因为多实例就有多个socket。远程连接多实例时，只需要指定host和port即可</td></tr> <tr><td>-U, --safe-updates</td> <td>Only allow UPDATE and DELETE that uses keys.</td></tr> <tr><td></td> <td>安全选项，强制在当前会话中执行 UPDATE 和 DELETE 操作时，必须指定条件例如 WHERE 。强烈建议使用这个参数可以在Linux系统中设置一个别名：alias mysql='mysql -U</td></tr> <tr><td>--max-allowed-packet=#</td> <td>The maximum packet length to send to or receive from server.</td></tr> <tr><td></td> <td>当前会话客户端与服务端传输数据时但个包的最大容量，默认是1M(1048576 B)。单个包越大，传输的次数越小，反之越多。一般设置4M 或根据实际网络情况设定</td></tr> <tr><td>--defaults-file=#</td> <td>Only read default options from the given file #</td></tr> <tr><td></td> <td>指定一个配置文件，mysql 将只从这个文件里读取选项配置。一般在多实例服务端上登陆时，需要指定配置文件，否则MySQL客户端程序会默认从/etc/my.cnf /etc/mysql/my.cnf /usr/local/mysql/etc/my.cnf ~/.my.cnf这个顺序去查找 my.cnf</td></tr></tbody></table> <h3 id="常见用法"><a href="#常见用法" class="header-anchor">#</a> 常见用法</h3> <p><strong>在服务端连接MySQL</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysql <span class="token parameter variable">-U</span> <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span>
</code></pre></div><p><strong>在服务端连接MySQL多实例</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysql <span class="token parameter variable">-U</span> --defaults-file<span class="token operator">=</span>/multi/3306/my.cnf <span class="token parameter variable">--socket</span><span class="token operator">=</span>/multi/3306/mysql.sock <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span>
</code></pre></div><p><strong>远程连接MySQL</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysql --safe-updates <span class="token parameter variable">--host</span><span class="token operator">=</span><span class="token number">192.168</span>.2.22 <span class="token parameter variable">--port</span><span class="token operator">=</span><span class="token number">3306</span> <span class="token parameter variable">--user</span><span class="token operator">=</span>root <span class="token parameter variable">--password</span>
mysql <span class="token parameter variable">-U</span> <span class="token parameter variable">-h192.168.2.22</span> <span class="token parameter variable">-P3306</span> <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span>
</code></pre></div><p><strong>执行SQL语句后退出，用bash命令进行处理</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysql <span class="token parameter variable">-U</span> <span class="token parameter variable">-h192.168.2.22</span> <span class="token parameter variable">-P3306</span> <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;select * from mysql.user;&quot;</span> <span class="token operator">|</span><span class="token function">grep</span> xxx
</code></pre></div><p><strong>导入SQL脚本文件，恢复数据</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysql <span class="token parameter variable">-U</span> <span class="token parameter variable">-h192.168.2.22</span> <span class="token parameter variable">-P3306</span> <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> <span class="token operator">&lt;</span> data.sql
</code></pre></div><h2 id="mysqladmin"><a href="#mysqladmin" class="header-anchor">#</a> mysqladmin</h2> <h3 id="常用参数-2"><a href="#常用参数-2" class="header-anchor">#</a> 常用参数</h3> <table><thead><tr><th>选项</th> <th>说明</th></tr></thead> <tbody><tr><td>-c, --count=#</td> <td>Number of iterations to make. This works with -i(--sleep) only.</td></tr> <tr><td></td> <td>执行命令的次数，只能与-i一起使用</td></tr> <tr><td>-i, --sleep=#</td> <td>Execute commands repeatedly with a sleep between.</td></tr> <tr><td></td> <td>执行命令的间隔时间，单位是秒，通常与-c一起使用，如果不指定-c次数，命令将一直执行下去</td></tr> <tr><td>-h, --host=name</td> <td>Connect to host.</td></tr> <tr><td></td> <td>指定连接的MySQL服务器</td></tr> <tr><td>-p, --password[=name]</td> <td>Password to use when connecting to server. If password is not given it is asked from the tty.</td></tr> <tr><td></td> <td>指定密码</td></tr> <tr><td>-P, --port=#</td> <td>Port number to use for connection or 0 for default to, in order of preference, my.cnf, $MYSQL_TCP_PORT,/etc/services, built-in default (3306).</td></tr> <tr><td></td> <td>指定连接端口</td></tr> <tr><td>-S, --socket=name</td> <td>The socket file to use for connection.</td></tr> <tr><td></td> <td>指定socket</td></tr> <tr><td>-u, --user=name</td> <td>User for login if not current user.</td></tr> <tr><td></td> <td>指定连接的用户</td></tr> <tr><td>--defaults-file=#</td> <td>Only read default options from the given file #.</td></tr> <tr><td></td> <td>指定配置文件</td></tr></tbody></table> <h3 id="常用命令"><a href="#常用命令" class="header-anchor">#</a> 常用命令</h3> <table><thead><tr><th>选项</th> <th>说明</th></tr></thead> <tbody><tr><td>create databasename</td> <td>Create a new database</td></tr> <tr><td></td> <td>创建数据库，与mysql命令的-e参数执行SQL语句或在MySQL客户端执行SQL语句效果一样</td></tr> <tr><td>drop databasename</td> <td>Delete a database and all its tables</td></tr> <tr><td></td> <td>删除数据库，与mysql命令的-e参数执行SQL语句或在MySQL客户端执行SQL语句效果一样</td></tr> <tr><td>extended-status</td> <td>Gives an extended status message from the server</td></tr> <tr><td></td> <td>显示MySQL服务器的全局状态，等同于执行&quot;SHOW GLOBAL STATUS;&quot;</td></tr> <tr><td>flush-hosts</td> <td>Flush all cached hosts</td></tr> <tr><td></td> <td>清空主机缓存。如果服务端的IP或者主机名发生了变化，或者从客户端连接时Host 'host_name' is blocked ，可以执行这个命令。一般在失败连接次数超过max_connect_errors (默认是100)时，会提示 blocked相当于执行SQL语句：FLUSH HOSTS</td></tr> <tr><td>flush-logs</td> <td>Flush all logs</td></tr> <tr><td></td> <td>刷新binlog日志，相当于执行SQL语句：FLUSH LOGS</td></tr> <tr><td>flush-threads</td> <td>Flush the thread cache</td></tr> <tr><td></td> <td>刷新线程的缓存，没有对应的SQL语句</td></tr> <tr><td>flush-privileges</td> <td>Reload grant tables (same as reload)</td></tr> <tr><td></td> <td>刷新权限，相当于执行SQL语句：FLUSH PRIVILEGES</td></tr> <tr><td>password [new-password]</td> <td>Change old password to new-password in current format</td></tr> <tr><td></td> <td>设置一个新密码，通常需要指定用户-u 。如果原密码不为空，需要-p old-password或指定原密码</td></tr> <tr><td>old-password [new-password]</td> <td>Change old password to new-password in old format</td></tr> <tr><td></td> <td>更改密码</td></tr> <tr><td>processlist</td> <td>Show list of active threads in server</td></tr> <tr><td></td> <td>显示正在执行的线程，相当于执行SQL语句：&quot;SHOW PROCESSLIST;&quot;root用户可以查看所有，普通用户只能查看权限内的线程</td></tr> <tr><td>reload</td> <td>Reload grant</td></tr> <tr><td></td> <td>等同于flush-privileges</td></tr> <tr><td>shutdown</td> <td>Take server down</td></tr> <tr><td></td> <td>平滑关闭服务器，如果是多实例要指定socket。</td></tr> <tr><td>status</td> <td>Gives a short status message from the server</td></tr> <tr><td></td> <td>查看MySQL服务器的简略的状态</td></tr> <tr><td>start-slave</td> <td>Start slave</td></tr> <tr><td></td> <td>启用slave</td></tr> <tr><td>stop-slave</td> <td>Stop slave</td></tr> <tr><td></td> <td>关闭slave</td></tr> <tr><td>variables</td> <td>Prints variables available</td></tr> <tr><td></td> <td>显示MySQL服务器的全局变量，相当于执行SQL语句：&quot;SHOW GLOBAL VARIABLES;&quot;</td></tr> <tr><td>ping</td> <td>Check if mysqld is alive</td></tr> <tr><td></td> <td>检查MySQL服务器是否可用</td></tr> <tr><td>version</td> <td>Get version info from server</td></tr> <tr><td></td> <td>查看MySQL服务器的版本和基本信息</td></tr></tbody></table> <h3 id="常见用法-2"><a href="#常见用法-2" class="header-anchor">#</a> 常见用法</h3> <p>在多实例服务端执行命令时，要指定 <code>--socket=</code>
在远程连接服务端执行命令时，要指定 <code>--host=</code> 和 <code>--port=</code>
在单实例默认安装的服务端执行命令时，不需要指定 <code>--socket=</code> 或者 <code>--host=</code>、<code>--port=</code></p> <p>以下示例为单实例服务端为例</p> <p><strong>设置密码，一般在MySQL服务器初始化之后设置root密码(在服务端执行)</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqladmin <span class="token parameter variable">-uroot</span> password <span class="token string">'PASSWORD'</span>
</code></pre></div><p><strong>修改密码，需要旧密码</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqladmin <span class="token parameter variable">-uroot</span> -p<span class="token string">'OLDPASSOWRD'</span> password <span class="token string">'PASSWORD'</span>
或
mysqladmin <span class="token parameter variable">-uroot</span> old-password <span class="token string">'OLDPASSOWRD'</span> password <span class="token string">'PASSWORD'</span>
</code></pre></div><p><strong>查看MySQL服务器是否可用</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqladmin <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> <span class="token function">ping</span>
mysqld is alive
</code></pre></div><p><strong>查看MySQL服务器的版本和基本信息</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqladmin <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> version
mysqladmin Ver <span class="token number">8.42</span> Distrib <span class="token number">5.5</span>.59, <span class="token keyword">for</span> Linux on x86_64
Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">2000</span>, <span class="token number">2018</span>, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Server version <span class="token number">5.5</span>.59-log
Protocol version <span class="token number">10</span>
Connection Localhost via UNIX socket
UNIX socket /multi/3306/mysql.sock
Uptime: <span class="token number">2</span> days <span class="token number">17</span> hours <span class="token number">30</span> min <span class="token number">46</span> sec

Threads: <span class="token number">1</span> Questions: <span class="token number">1901</span> Slow queries: <span class="token number">0</span> Opens: <span class="token number">117</span> Flush tables: <span class="token number">5</span> Open tables: <span class="token number">26</span> Queries per second avg: <span class="token number">0.008</span>
</code></pre></div><p><strong>每隔2秒，查看一次服务器的状态，总共执行5次</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqladmin <span class="token parameter variable">-uroot</span> -p<span class="token string">'PASSWORD'</span> <span class="token parameter variable">-i</span> <span class="token number">2</span> <span class="token parameter variable">-c</span> <span class="token number">5</span> status
Uptime: <span class="token number">236133</span> Threads: <span class="token number">1</span> Questions: <span class="token number">1905</span> Slow queries: <span class="token number">0</span> Opens: <span class="token number">117</span> Flush tables: <span class="token number">5</span> Open tables: <span class="token number">26</span> Queries per second avg: <span class="token number">0.008</span>
</code></pre></div><p><strong>查看MySQL服务器当前的状态</strong></p> <p>等同于SQL语句 <code>SHOW GLOBAL STATUS;</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqladmin <span class="token parameter variable">-uroot</span> -p<span class="token string">'PASSWORD'</span> extended-status
+------------------------------------------+-------------+
<span class="token operator">|</span> Variable_name                            <span class="token operator">|</span> Value       <span class="token operator">|</span>
+------------------------------------------+-------------+
<span class="token operator">|</span> Aborted_clients                          <span class="token operator">|</span> <span class="token number">4</span>           <span class="token operator">|</span>
<span class="token operator">|</span> Aborted_connects                         <span class="token operator">|</span> <span class="token number">17</span>          <span class="token operator">|</span>
<span class="token operator">|</span> Binlog_cache_disk_use                    <span class="token operator">|</span> <span class="token number">1</span>           <span class="token operator">|</span>
<span class="token operator">|</span> Binlog_cache_use                         <span class="token operator">|</span> <span class="token number">45</span>          <span class="token operator">|</span>
<span class="token operator">|</span> Binlog_stmt_cache_disk_use               <span class="token operator">|</span> <span class="token number">0</span>           <span class="token operator">|</span>
<span class="token operator">|</span> Binlog_stmt_cache_use                    <span class="token operator">|</span> <span class="token number">1</span>           <span class="token operator">|</span>
<span class="token operator">|</span> Bytes_received                           <span class="token operator">|</span> <span class="token number">471448</span>      <span class="token operator">|</span>
<span class="token operator">|</span> Bytes_sent                               <span class="token operator">|</span> <span class="token number">3454976</span>     <span class="token operator">|</span>
<span class="token operator">|</span> Com_admin_commands                       <span class="token operator">|</span> <span class="token number">3</span>           <span class="token operator">|</span>
<span class="token operator">|</span> Com_assign_to_keycache                   <span class="token operator">|</span> <span class="token number">0</span>           <span class="token operator">|</span>
<span class="token operator">|</span> Com_alter_db                             <span class="token operator">|</span> <span class="token number">0</span>           <span class="token operator">|</span>
<span class="token operator">|</span> Com_alter_db_upgrade                     <span class="token operator">|</span> <span class="token number">0</span>           <span class="token operator">|</span>
<span class="token operator">|</span> Com_alter_event                          <span class="token operator">|</span> <span class="token number">0</span>           <span class="token operator">|</span>
<span class="token operator">|</span> Com_alter_function                       <span class="token operator">|</span> <span class="token number">0</span>           <span class="token operator">|</span>
<span class="token operator">|</span> Com_alter_procedure                      <span class="token operator">|</span> <span class="token number">0</span>           <span class="token operator">|</span>
<span class="token operator">|</span> Com_alter_server                         <span class="token operator">|</span> <span class="token number">0</span>           <span class="token operator">|</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.
</code></pre></div><p><strong>查看MySQL服务器的系统变量</strong></p> <p>等同于SQL语句 <code>SHOW GLOBAL VARIABLES;</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqladmin <span class="token parameter variable">-uroot</span> -p<span class="token string">'PASSWORD'</span> variables
+---------------------------------------------------+------------------------------+
<span class="token operator">|</span> Variable_name                                     <span class="token operator">|</span> Value                        <span class="token operator">|</span>
+---------------------------------------------------+------------------------------+
<span class="token operator">|</span> auto_increment_increment                          <span class="token operator">|</span> <span class="token number">1</span>                            <span class="token operator">|</span>
<span class="token operator">|</span> auto_increment_offset                             <span class="token operator">|</span> <span class="token number">1</span>                            <span class="token operator">|</span>
<span class="token operator">|</span> autocommit                                        <span class="token operator">|</span> ON                           <span class="token operator">|</span>
<span class="token operator">|</span> automatic_sp_privileges                           <span class="token operator">|</span> ON                           <span class="token operator">|</span>
<span class="token operator">|</span> back_log                                          <span class="token operator">|</span> <span class="token number">50</span>                           <span class="token operator">|</span>
<span class="token operator">|</span> basedir                                           <span class="token operator">|</span> /usr/local/mysql-5.5.59      <span class="token operator">|</span>
<span class="token operator">|</span> big_tables                                        <span class="token operator">|</span> OFF                          <span class="token operator">|</span>
<span class="token operator">|</span> binlog_cache_size                                 <span class="token operator">|</span> <span class="token number">32768</span>                        <span class="token operator">|</span>
<span class="token operator">|</span> binlog_direct_non_transactional_updates           <span class="token operator">|</span> OFF                          <span class="token operator">|</span>
<span class="token operator">|</span> binlog_format                                     <span class="token operator">|</span> MIXED                        <span class="token operator">|</span>
<span class="token operator">|</span> binlog_stmt_cache_size                            <span class="token operator">|</span> <span class="token number">32768</span>                        <span class="token operator">|</span>
<span class="token operator">|</span> bulk_insert_buffer_size                           <span class="token operator">|</span> <span class="token number">8388608</span>                      <span class="token operator">|</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.
</code></pre></div><p><strong>查看MySQL服务器的运行中的线程</strong></p> <p>每秒刷新 <code>1</code> 次。等同于 <code>SQL</code> 语句 <code>SHOW PROCESSLIST;</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqladmin <span class="token parameter variable">-uroot</span> -p<span class="token string">'PASSWORD'</span> <span class="token parameter variable">-i</span> <span class="token number">1</span> processlist
+-----+------+-----------+----+---------+------+-------+------------------+
<span class="token operator">|</span> Id  <span class="token operator">|</span> User <span class="token operator">|</span> Host      <span class="token operator">|</span> db <span class="token operator">|</span> Command <span class="token operator">|</span> Time <span class="token operator">|</span> State <span class="token operator">|</span> Info             <span class="token operator">|</span>
+-----+------+-----------+----+---------+------+-------+------------------+
<span class="token operator">|</span> <span class="token number">145</span> <span class="token operator">|</span> root <span class="token operator">|</span> localhost <span class="token operator">|</span>    <span class="token operator">|</span> Query   <span class="token operator">|</span> <span class="token number">0</span>    <span class="token operator">|</span>       <span class="token operator">|</span> show processlist <span class="token operator">|</span>
+-----+------+-----------+----+---------+------+-------+------------------+
</code></pre></div><p><strong>创建数据库</strong></p> <p>等同于 <code>SQL</code> 语句 <code>CREATE DATABASE linuxd;</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqladmin <span class="token parameter variable">-uroot</span> -p<span class="token string">'PASSWORD'</span> create linuxd
</code></pre></div><p><strong>删除数据库</strong></p> <p>等同于 <code>SQL</code> 语句 <code>DROP DATABASE linuxd;</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqladmin <span class="token parameter variable">-uroot</span> -p<span class="token string">'PASSWORD'</span> drop linuxd
</code></pre></div><p><strong>刷新数据库的权限</strong></p> <p>相当于执行SQL语句 <code>FLUSH PRIVILEGES</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqladmin <span class="token parameter variable">-uroot</span> -p<span class="token string">'PASSWORD'</span> reload
或
mysqladmin <span class="token parameter variable">-uroot</span> -p<span class="token string">'PASSWORD'</span> flush-privileges
</code></pre></div><p><strong>平滑关闭服务器</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqladmin <span class="token parameter variable">-uroot</span> -p<span class="token string">'PASSWORD'</span> <span class="token function">shutdown</span>
</code></pre></div><p><strong>关闭数据库中正在执行的线程</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqladmin <span class="token parameter variable">-uroot</span> -p<span class="token string">'PASSWORD'</span> processlist
mysqladmin <span class="token parameter variable">-uroot</span> -p<span class="token string">'PASSWORD'</span> <span class="token function">kill</span> ID_NUMBER
</code></pre></div><p><strong>同时执行多个命令</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqladmin <span class="token parameter variable">-uroot</span> -p<span class="token string">'PASSWORD'</span> status processlist <span class="token function">ping</span>
</code></pre></div><h2 id="mysqlbinlog"><a href="#mysqlbinlog" class="header-anchor">#</a> mysqlbinlog</h2> <h3 id="常用参数-3"><a href="#常用参数-3" class="header-anchor">#</a> 常用参数</h3> <table><thead><tr><th>选项</th> <th>说明</th></tr></thead> <tbody><tr><td>-d, --database=name</td> <td>List entries for just this database (local log only).</td></tr> <tr><td></td> <td>指定一个数据库名，输出的日志中将只包含指定的数据库相关的信息,由于binlog是记录数据库中所有库表的日志，使用这个选项就只输出某个数据库的日志,这个选项只能在本地服务端上使用</td></tr> <tr><td>--base64-output[=name]</td> <td>Determine when the output statements should be base64-encoded BINLOG statements: 'never' disables it and works only for binlogs without row-based events; 'decode-rows' decodes row events into commented pseudo-SQL statements if the --verbose option is also  given; 'auto' prints base64 only when necessary (i.e.,for row-based events and format description events).  If no --base64-output[=name] option is given at all, the default is 'auto'.</td></tr> <tr><td></td> <td>这个选项=decode-rows时可以把基于ROW的binlog_format所产生的binlog解析成可读的SQL语句，默认是=auto。使用这个选项时需要搭配-v选项</td></tr> <tr><td>-D, --disable-log-bin</td> <td>Disable binary log. This is useful, if you enabled --to-last-log and are sending the output to the same MySQL server. This way you could avoid an endless loop.You would also like to use it when restoring after a crash to avoid duplication of the statements you already have. NOTE: you will need a SUPER privilege to use this option.</td></tr> <tr><td></td> <td>在执行mysqlbinlog命令时禁用服务器的binlog日志记录，如果使用了--to-last-log参数mysqlbinlog命令可能会一直输出结果，这个选项可以避免出现死循环，需要root权限</td></tr> <tr><td>-h, --host=name</td> <td>Get the binlog from server.</td></tr> <tr><td></td> <td>指定IP或主机名</td></tr> <tr><td>-o, --offset=#</td> <td>Skip the first N entries.</td></tr> <tr><td></td> <td>跳过前N行输出结果</td></tr> <tr><td>-p, --password[=name]</td> <td>Password to connect to remote server.</td></tr> <tr><td></td> <td>指定密码</td></tr> <tr><td>-P, --port=#</td> <td>Port number to use for connection or 0 for default to, in order of preference, my.cnf, $MYSQL_TCP_PORT,/etc/services, built-in default (3306).</td></tr> <tr><td></td> <td>指定端口</td></tr> <tr><td>-R, --read-from-remote-server</td> <td>Read binary logs from a MySQL server.</td></tr> <tr><td></td> <td>在对远程服务器执行mysqlbinlog时，需要指定这个选项才能生效</td></tr> <tr><td>-r, --result-file=name</td> <td>Direct output to a given file.</td></tr> <tr><td></td> <td>把结果输出到文件，相当于重定向 &gt;</td></tr> <tr><td>--server-id=#</td> <td>Extract only binlog entries created by the server having the given id.</td></tr> <tr><td></td> <td>指定server id</td></tr> <tr><td>--set-charset=name</td> <td>Add 'SET NAMES character_set' to the output.</td></tr> <tr><td></td> <td>在输出结果中添加SQL语句'SET NAMES character_set'</td></tr> <tr><td>-s, --short-form</td> <td>Just show regular queries: no extra info and no row-based events. This is for testing only, and should not be used in production systems. If you want to suppress base64-output, consider using --base64-output=never instead.</td></tr> <tr><td></td> <td>输出相对简短一点的结果，结果中将不包含位置和时间等信息,这个选项仅用于测试，不建议在生产环境使用</td></tr> <tr><td>-S, --socket=name</td> <td>The socket file to use for connection.</td></tr> <tr><td></td> <td>指定socket</td></tr> <tr><td>--start-datetime=name</td> <td>Start reading the binlog at first event having a datetime equal or posterior to the argument; the argument must be a date and time in the local time zone, in any format accepted by the MySQL server for DATETIME and TIMESTAMP types, for example: 2004-12-25 11:25:56 (you should probably use quotes for your bash to set it properly).</td></tr> <tr><td></td> <td>指定日志中的起始时间，一般格式是 2004-12-25 11:25:56 ，如果不指定结束时间,将从起始时间一直输出到末尾</td></tr> <tr><td>-j, --start-position=#</td> <td>Start reading the binlog at position N. Applies to the first binlog passed on the command line.</td></tr> <tr><td></td> <td>指定日志中的起始位置，一般可以搭配结束位置使用。如果不指定结束位置，将从起始位置一直输出到末尾</td></tr> <tr><td>--stop-datetime=name</td> <td>Stop reading the binlog at first event having a datetime equal or posterior to the argument; the argument must be a date and time in the local time zone, in any format accepted by the MySQL server for DATETIME and TIMESTAMP types, for example: 2004-12-25 11:25:56 (you should probably use quotes for your bash to set it properly).</td></tr> <tr><td></td> <td>指定日志中的结束时间，一般格式是 2004-12-25 11:25:56 ，如果不指定起始时间,将从binlog文件开始一直输出到结束时间</td></tr> <tr><td>--stop-position=#</td> <td>Stop reading the binlog at position N. Applies to the last binlog passed on the command line.</td></tr> <tr><td></td> <td>指定结束位置，如果不指定起始位置，将从binlog文件的开始一直输出到结束位置</td></tr> <tr><td>-t, --to-last-log</td> <td>Requires -R. Will not stop at the end of the requested binlog but rather continue printing until the end of the last binlog of the MySQL server. If you send the output to the same MySQL server, that may lead to an endless loop.</td></tr> <tr><td></td> <td>这个选项是用于对远程服务器操作的场景，它将从开始的binlog文件一直往下执行,如果服务器一直有binlog日志产生，那么mysqlbinlog命令将一直执行下去，造成循环.指定--disable-log-bin选项，可以避免循环的出现</td></tr> <tr><td>-v, --verbose</td> <td>Reconstruct SQL statements out of row events. -v -v adds comments on column data types.</td></tr> <tr><td></td> <td>在binlog_format=ROW 时，配合--base64-output把binlog日志解析成可读的SQL语句</td></tr> <tr><td>-u, --user=name</td> <td>Connect to the remote server as username.</td></tr> <tr><td></td> <td>指定远程服务器的用户名</td></tr></tbody></table> <h3 id="常见用法-3"><a href="#常见用法-3" class="header-anchor">#</a> 常见用法</h3> <p>在多实例服务端执行命令时，要指定 <code>--socket=</code>
在远程连接服务端执行命令时，要指定 <code>--host=</code> 和 <code>--port=</code> 和 <code>--read-from-remote-server</code>
在单实例默认安装的服务端执行命令时，不需要指定 <code>--socket=</code> 或者<code>--host=</code> <code>--port=</code></p> <p><strong>查看binary log文件列表，一般位于数据目录下</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SHOW</span> <span class="token keyword">BINARY</span> LOGS<span class="token punctuation">;</span> <span class="token comment"># SHOW MASTER LOGS;</span>
<span class="token operator">+</span><span class="token comment">-----------------------+------------+</span>
<span class="token operator">|</span> Log_name              <span class="token operator">|</span> File_size  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------+---------+</span>
<span class="token operator">|</span> mysqld<span class="token operator">-</span>bin<span class="token punctuation">.</span><span class="token number">000001</span>     <span class="token operator">|</span>     <span class="token number">15740</span>  <span class="token operator">|</span>
<span class="token operator">|</span> mysqld<span class="token operator">-</span>bin<span class="token punctuation">.</span><span class="token number">000002</span>     <span class="token operator">|</span>      <span class="token number">3319</span>  <span class="token operator">|</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><p><strong>直接查看binary log</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqlbinlog mysqld-bin.000001 <span class="token operator">&gt;</span> test.sql
</code></pre></div><p><strong>解析ROW模式的binlog日志</strong></p> <p><code>--base64-outputm</code> 默认是 <code>auto</code> ，在下面命令中，也可以省略这个参数</p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqlbinlog mysqld-bin.000035 <span class="token parameter variable">-vv</span> --base64-output<span class="token operator">=</span>decode-rows
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token comment">### UPDATE `linuxd`.`test`</span>
<span class="token comment">### WHERE</span>
<span class="token comment">###   @1=8 /* INT meta=0 nullable=0 is_null=0 */</span>
<span class="token comment">###   @2='old' /* STRING(60) meta=65084 nullable=0 is_null=0 */</span>
<span class="token comment">###   @3=35 /* INT meta=0 nullable=0 is_null=0 */</span>
<span class="token comment">### SET</span>
<span class="token comment">###   @1=8 /* INT meta=0 nullable=0 is_null=0 */</span>
<span class="token comment">###   @2='new' /* STRING(60) meta=65084 nullable=0 is_null=0 */</span>
<span class="token comment">###   @3=35 /* INT meta=0 nullable=0 is_null=0 */</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.
mysqlbinlog mysqld-bin.000035 <span class="token parameter variable">-v</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token comment">### UPDATE `linuxd`.`test`</span>
<span class="token comment">### WHERE</span>
<span class="token comment">###   @1=8</span>
<span class="token comment">###   @2='old'</span>
<span class="token comment">###   @3=35</span>
<span class="token comment">### SET</span>
<span class="token comment">###   @1=8</span>
<span class="token comment">###   @2='new'</span>
<span class="token comment">###   @3=35</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.
</code></pre></div><p><strong>输出相对简短一点的结果</strong></p> <p>结果中将不包含位置和时间等信息</p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqlbinlog --short-form mysqld-bin.000001 <span class="token operator">&gt;</span> test.sql
</code></pre></div><p>如果输出结果中包含了下面信息，说明当前打开的 <code>binary log</code> 可能是服务器正在使用的日志
这个时候刷新刷新日志 <code>FLUSH LOGS</code></p> <blockquote><p>Warning: this binlog is either in use or was not closed properly.</p></blockquote> <p><strong>获取指定数据库的binary log</strong></p> <p><code>binlog</code> 记录的是服务器上所有库表的 <code>binary log</code> 。 <code>-d --database</code>可以只导出指定的数据库的 <code>binary log</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqlbinlog <span class="token parameter variable">--database</span> linuxd mysqld-bin.000001 <span class="token operator">&gt;</span> test.sql
</code></pre></div><p><strong>在执行mysqlbinlog命令时，跳过1000行输出结果</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqlbinlog <span class="token parameter variable">--offset</span><span class="token operator">=</span><span class="token number">1000</span> mysqld-bin.000001 <span class="token operator">&gt;</span> test.sql
</code></pre></div><p><strong>按时间提取日志</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqlbinlog --start-datetime<span class="token operator">=</span><span class="token string">&quot;2004-12-25 11:25:56&quot;</span> --stop-datetime<span class="token operator">=</span><span class="token string">&quot;2004-12-25 12:25:56&quot;</span> mysqld-bin.000001 <span class="token operator">&gt;</span> test.sql
</code></pre></div><p><strong>按位置提取日志</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqlbinlog --start-position<span class="token operator">=</span><span class="token number">15028</span> --stop-position<span class="token operator">=</span><span class="token number">16782</span> mysqld-bin.000001 <span class="token operator">&gt;</span> test.sql
</code></pre></div><p><strong>从远程服务器读取binary log</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqlbinlog --read-from-remote-server <span class="token parameter variable">--host</span><span class="token operator">=</span><span class="token number">192.168</span>.2.22 <span class="token parameter variable">--port</span><span class="token operator">=</span><span class="token number">3306</span> <span class="token parameter variable">--user</span><span class="token operator">=</span>root <span class="token parameter variable">--password</span> mysqld-bin.000001 <span class="token operator">&gt;</span> test.sql
</code></pre></div><p><strong>从远程服务器一直读取 binary log 到最后一个文件</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqlbinlog --read-from-remote-server <span class="token parameter variable">--host</span><span class="token operator">=</span><span class="token number">192.168</span>.2.22 <span class="token parameter variable">--port</span><span class="token operator">=</span><span class="token number">3306</span> <span class="token parameter variable">--user</span><span class="token operator">=</span>root <span class="token parameter variable">--password</span> --to-last-log --disable-log-bin mysqld-bin.000001 <span class="token operator">&gt;</span> test.sql
</code></pre></div><h2 id="mysqldump"><a href="#mysqldump" class="header-anchor">#</a> mysqldump</h2> <h3 id="常用参数-4"><a href="#常用参数-4" class="header-anchor">#</a> 常用参数</h3> <table><thead><tr><th>选项</th> <th>说明</th></tr></thead> <tbody><tr><td>--defaults-file=#</td> <td>Only read default options from the given file #.</td></tr> <tr><td></td> <td>指定配置文件，并只从这个配置文件里读取选项</td></tr> <tr><td>-A, --all-databases</td> <td>Dump all the databases. This will be same as --databases with all databases selected.</td></tr> <tr><td></td> <td>转存(备份)所有的数据库和表，使用-r或&gt;写到指定SQL文件里</td></tr> <tr><td>-i, --comments</td> <td>Write additional information.(Defaults to on; use --skip-comments to disable.)</td></tr> <tr><td></td> <td>在输出结果里添加一些说明信息，例如&quot;-- Dumping data for table test&quot;  --skip-comments 选项将不输出以&quot;--&quot;开头的注释信息，以&quot;/*&quot;开头的注释不影响</td></tr> <tr><td>--compatible=name</td> <td>Change the dump to be compatible with a given mode. Bydefault tables are dumped in a format optimized forMySQL. Legal modes are: ansi, mysql323, mysql40,postgresql, oracle, mssql, db2, maxdb, no_key_options,no_table_options, no_field_options. One can use several modes separated by commas. Note: Requires MySQL serverversion 4.1.0 or higher. This option is ignored with earlier server versions.</td></tr> <tr><td></td> <td>指定输出的SQL语句结果与ansi, mysql323, mysql40,postgresql, oracle, mssql等兼容，如果要兼容多个，使用--compatible=postgresql,oracle,mssql一般要导出数据后，导入到另一种数据库时使用这个选项，但不保证完全兼容</td></tr> <tr><td>--compact</td> <td>Give less verbose output (useful for debugging). Disables structure comments and header/footer constructs. Enables options --skip-add-drop-table --skip-add-locks --skip-comments --skip-disable-keys --skip-set-charset.</td></tr> <tr><td></td> <td>输出相对简略的结果，去掉了DROP TABLE、LOCKS、COMMENTS、KEYS、CHARSET等信息</td></tr> <tr><td>-c, --complete-insert</td> <td>Use complete insert statements.</td></tr> <tr><td></td> <td>使用完整的 INSERT INTO 语句，包含完整字段和完整值的语句，更加规范更加高效</td></tr> <tr><td>-C, --compress</td> <td>Use compression in server/client protocol.</td></tr> <tr><td></td> <td>在转存(备份)数据时使用压缩</td></tr> <tr><td>-a, --create-options</td> <td>Include all MySQL specific create options.(Defaults to on; use --skip-create-options to disable.)</td></tr> <tr><td></td> <td>转存(备份)数据时包含完整的创建信息，例如建表的AUTO_INCREMENT 、ENGINE=InnoDB等信息</td></tr> <tr><td>-B, --databases</td> <td>Dump several databases. Note the difference in usage; in this case no tables are given. All name arguments are regarded as database names. 'USE db_name;' will be included in the output.</td></tr> <tr><td></td> <td>指定要转存(备份)的数据库名，如果不使用这个选项，那么输出的结果中将不包含 CREATE DATABASE 和 USE 语句，因此强烈建议指定这个选项</td></tr> <tr><td>-E, --events</td> <td>Dump events.</td></tr> <tr><td></td> <td>如果数据库中有事件，需要指定这个选项。在使用 --all-databases 导出所有数据时要指定这个选项，MySQL服务器本身的数据库中有events</td></tr> <tr><td>-F, --flush-logs</td> <td>Flush logs file in server before starting dump. Note that if you dump many databases at once (using the option --databases= or --all-databases), the logs will be flushed for each database dumped. The exception is when using --lock-all-tables or --master-data: in this case the logs will be flushed only once, corresponding to themom ent all tables are locked. So if you want your dump and the log flush to happen at the same exact moment you should use --lock-all-tables or --master-data with --flush-logs.</td></tr> <tr><td></td> <td>转存(备份)数据时刷新(分割)binlog日志，如果指定了 --all-databases 备份所有数据库那么备份每个数据库时都要刷新一次。如果指定了--lock-all-tables 或 --master-data 就只刷新一次binlog</td></tr> <tr><td>--flush-privileges</td> <td>Emit a FLUSH PRIVILEGES statement after dumping the mysql database. This option should be used any time the dump contains the mysql database and any other database that depends on the data in the mysql database for proper restore.</td></tr> <tr><td></td> <td>在转存完成后，发送一个&quot;FLUSH PRIVILEGES&quot;语句刷新数据库的权限</td></tr> <tr><td>-f, --force</td> <td>Continue even if we get an SQL error.</td></tr> <tr><td></td> <td>强制执行，遇到SQL错误也继续</td></tr> <tr><td>-h, --host=name</td> <td>Connect to host.</td></tr> <tr><td></td> <td>指定主机IP或主机名</td></tr> <tr><td>--ignore-table=name</td> <td>Do not dump the specified table. To specify more than one table to ignore, use the directive multiple times, once for each table. Each table must be specified with both database and table names, e.g.,--ignore-table=database.table.</td></tr> <tr><td></td> <td>转存时指定忽略的表，使用 --ignore-table=database.table1 --ignore-table=database.table2 指定多个表，必须包含完整的database.table</td></tr> <tr><td>-x, --lock-all-tables</td> <td>Locks all tables across all databases. This is achieved by taking a global read lock for the duration of the whole dump. Automatically turns --single-transaction and --lock-tables off.</td></tr> <tr><td></td> <td>锁定数据库里所有的表，所有客户端在转存(备份)数据的时候将不能执行操作启用这个选项的时候，--single-transaction 和 --lock-tables 选项将被关闭</td></tr> <tr><td>-l, --lock-tables</td> <td>Lock all tables for read.(Defaults to on; use --skip-lock-tables to disable.)</td></tr> <tr><td></td> <td>转存时把当前正在导出的数据库的表锁定为只读状态，将不能进行插入和修改操作</td></tr> <tr><td>--log-error=name</td> <td>Append warnings and errors to given file.</td></tr> <tr><td></td> <td>指定一个错误日志输出的文件</td></tr> <tr><td>--master-data[=#]</td> <td>This causes the binary log position and filename to be appended to the output. If equal to 1, will print it as a CHANGE MASTER command; if equal to 2, that command will be prefixed with a comment symbol. This option will turn --lock-all-tables on, unless --single-transaction is specified too (in which case a global read lock is only taken a short time at the beginning of the dump; do not forget to read about --single-transaction below). In all cases, any action on logs will happen at the exact moment of the dump. Option automatically turns --lock-tables off.</td></tr> <tr><td></td> <td>如果=1，向输出结果中添加 CHANGE MASTER 命令，如果=2，则注释 CHANGE MASTER 命令，在备份MyISAM引擎的数据库时，--master-data 和 --lock-all-tables 一起使用，在备份InnoDB引擎的数据库时，--master-data 和 --single-transaction 一起使用</td></tr> <tr><td>--max-allowed-packet=#</td> <td>The maximum packet length to send to or receive from server.</td></tr> <tr><td></td> <td>指定当前会话的单个包的最大容量</td></tr> <tr><td>-t, --no-create-info</td> <td>Do not write table creation info.</td></tr> <tr><td></td> <td>输出结果中没有创建表的信息，只有insert数据的信息，即只备份数据，不备份表结构</td></tr> <tr><td>-d, --no-data</td> <td>No row information.</td></tr> <tr><td></td> <td>输出结果中只包含表结构，不包含数据</td></tr> <tr><td>--order-by-primary</td> <td>Sorts each table’s rows by primary key, or first unique key, if such a key exists. Useful when dumping a MyISAM table to be loaded into an InnoDB table, but will make the dump itself take considerably longer.</td></tr> <tr><td></td> <td>如果存在主键或唯一键，那么在表导出时就按它排列。通常用在导出MyISAM库然后导入到InnoDB库中，但是会花费很长时间</td></tr> <tr><td>-p, --password[=name]</td> <td>Password to use when connecting to server. If password is not given it’s solicited on the tty.</td></tr> <tr><td></td> <td>指定密码</td></tr> <tr><td>-P, --port=#</td> <td>Port number to use for connection.</td></tr> <tr><td></td> <td>指定端口</td></tr> <tr><td>-r, --result-file=name</td> <td>Direct output to a given file. This option should be used in systems (e.g., DOS, Windows) that use carriage-return linefeed pairs (\r\n) to separate text lines. This option ensures that only a single newline is used.</td></tr> <tr><td></td> <td>把输出结果写到文件里，相当于重定向符 &gt;</td></tr> <tr><td>--single-transaction</td> <td>Creates a consistent snapshot by dumping all tables in a single transaction. Works ONLY for tables stored in storage engines which support multiversioning (currently only InnoDB does); the dump is NOT guaranteed to be consistent for other storage engines. While a --single-transaction dump is in process, to ensure a valid dump file (correct table contents and binary log position), no other connection should use the following statements: ALTER TABLE, DROP TABLE, RENAME TABLE,TRUNCATE TABLE, as consistent snapshot is not isolated from them. Option automatically turns off --lock-tables.</td></tr> <tr><td></td> <td>单事务处理，基本上InnoDB引擎的数据库转存(备份)数据时使用它。原理是在处理当前会话时，其他的线程执行的操作不会影响这个转存数据的会话，一般与 --master-data 选项搭配使用，在输出结果中指定CHANGE MASTER语句和位置，保证数据备份的一致性和完整性</td></tr> <tr><td>-S, --socket=name</td> <td>The socket file to use for connection.</td></tr> <tr><td></td> <td>指定socket</td></tr> <tr><td>--tables</td> <td>Overrides option --databases (-B).</td></tr> <tr><td></td> <td>只导出表的时候使用，需要配合 --databases 使用</td></tr> <tr><td>--triggers</td> <td>Dump triggers for each dumped table.(Defaults to on; use --skip-triggers to disable.)</td></tr> <tr><td></td> <td>如果数据库中有触发器，将一起导出</td></tr> <tr><td>-u, --user=name</td> <td>User for login if not current user.</td></tr> <tr><td></td> <td>指定用户</td></tr> <tr><td>--tz-utc</td> <td>SET TIME_ZONE='+00:00' at top of dump to allow dumping of TIMESTAMP data when a server has data in different time zones or data is being moved between servers with different time zones.</td></tr> <tr><td></td> <td>在转存数据之前设置时区。一般在两个不同时区的服务器之前转存数据时使用这个选项</td></tr></tbody></table> <h3 id="常见用法-4"><a href="#常见用法-4" class="header-anchor">#</a> 常见用法</h3> <p>在多实例服务端执行命令时，要指定 <code>--socket=</code>
在远程连接服务端执行命令时，要指定 <code>--host=</code> 和 <code>--port=</code>
在单实例默认安装的服务端执行命令时，不需要指定 <code>--socket=</code> 或者 <code>--host=</code> <code>--port=</code></p> <p>下面示例以单实例服务端为例</p> <p><strong>备份一个数据库</strong></p> <p>如果不带 <code>--databases</code>，输出结果将不包含 <code>CREATE DATABASE</code> 和 <code>USE</code> 语句</p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqldump <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> <span class="token parameter variable">--databases</span> linuxd <span class="token operator">&gt;</span> test.sql
</code></pre></div><p>使用压缩</p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqldump <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> <span class="token parameter variable">--databases</span> linuxd <span class="token operator">|</span> <span class="token function">gzip</span> <span class="token operator">&gt;</span> test.sql.gz
</code></pre></div><p><strong>备份所有数据库</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqldump <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> --all-databases <span class="token operator">&gt;</span> test.sql
</code></pre></div><p>使用压缩</p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqldump <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> --all-databases <span class="token operator">|</span> <span class="token function">gzip</span> <span class="token operator">&gt;</span> test.sql.gz
</code></pre></div><p><strong>备份某一个数据库的几张表</strong></p> <p><code>--databases</code> <code>--tables</code> 也可以不显示的指定</p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqldump <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> <span class="token parameter variable">--databases</span> linuxd <span class="token parameter variable">--tables</span> <span class="token builtin class-name">test</span> test1 <span class="token operator">&gt;</span> test.sql
mysqldump <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> linuxd <span class="token builtin class-name">test</span> test1 <span class="token operator">&gt;</span> test.sql
</code></pre></div><p>使用压缩</p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqldump <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> <span class="token parameter variable">--databases</span> linuxd <span class="token parameter variable">--tables</span> <span class="token builtin class-name">test</span> test1 <span class="token operator">|</span> <span class="token function">gzip</span>  <span class="token operator">&gt;</span> test.sql.gz
mysqldump <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> linuxd <span class="token builtin class-name">test</span> test1 <span class="token operator">|</span> <span class="token function">gzip</span> <span class="token operator">&gt;</span> test.sql.gz
</code></pre></div><p><strong>备份多个数据库</strong></p> <p>如果有事件，要加 <code>--events</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqldump <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> <span class="token parameter variable">--databases</span> linuxd linuxd1 <span class="token operator">&gt;</span> test.sql
</code></pre></div><p>使用压缩</p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqldump <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> <span class="token parameter variable">--databases</span> linuxd linuxd1 <span class="token operator">|</span> <span class="token function">gzip</span> <span class="token operator">&gt;</span> test.sql.gz
</code></pre></div><p><strong>只备份数据库的表结构，可以指定多个库</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqldump <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> --no-data <span class="token parameter variable">--databases</span> linuxd linuxd1 <span class="token operator">&gt;</span> test.sql
</code></pre></div><p>使用压缩</p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqldump <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> --no-data <span class="token parameter variable">--databases</span> linuxd linuxd1 <span class="token operator">|</span> <span class="token function">gzip</span> <span class="token operator">&gt;</span> test.sql.gz
</code></pre></div><p><strong>只备份数据，不要库和表结构</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqldump <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> --no-create-info <span class="token parameter variable">--databases</span> linuxd linuxd1 <span class="token operator">&gt;</span> test.sql
</code></pre></div><p>使用压缩</p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqldump <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> --no-create-info <span class="token parameter variable">--databases</span> linuxd linuxd1 <span class="token operator">|</span> <span class="token function">gzip</span> <span class="token operator">&gt;</span> test.sql.gz
</code></pre></div><p><strong>MyISAM引擎的数据库表备份</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqldump <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> <span class="token parameter variable">--opt</span> --master-data<span class="token operator">=</span><span class="token number">2</span> --lock-all-tables <span class="token parameter variable">--events</span> <span class="token parameter variable">--routines</span> <span class="token parameter variable">--triggers</span> --flush-logs <span class="token parameter variable">--databases</span> db1 <span class="token operator">&gt;</span> db1.sql
</code></pre></div><p><strong>InnoDB引擎的数据库表备份</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqldump <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> <span class="token parameter variable">--opt</span> --master-data<span class="token operator">=</span><span class="token number">2</span> --single-transaction <span class="token parameter variable">--events</span> <span class="token parameter variable">--routines</span> <span class="token parameter variable">--triggers</span> --flush-logs <span class="token parameter variable">--databases</span> db1 <span class="token operator">&gt;</span> db1.sql
</code></pre></div><p><strong>MyISAM引擎的数据库表导出后，导入到InnoDB引擎的数据库表</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqldump <span class="token parameter variable">--user</span><span class="token operator">=</span>root <span class="token parameter variable">--password</span> <span class="token parameter variable">--events</span> --order-by-primary --flush-logs --lock-all-tables --master-data<span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">--databases</span> linuxd linuxd1 <span class="token operator">|</span><span class="token function">gzip</span> <span class="token operator">&gt;</span> test.sql.gz
</code></pre></div><p><strong>恢复数据</strong></p> <p><code>SQL</code> 脚本中包含了 <code>CREATE DATABASE</code> 和 <code>USE</code> 语句</p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysql <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> <span class="token operator">&lt;</span> test.sql
</code></pre></div><p><strong>指定数据库恢复数据</strong></p> <p><code>SQL</code> 脚本中不包含 <code>CREATE DATABASE</code> 和 <code>USE</code> 语句</p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysql <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span> linuxd <span class="token operator">&lt;</span> test.sql
</code></pre></div><p><strong>在MySQL客户端命令行下恢复数据，指定SQL脚本的绝对或相对路径</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> EXIST linuxd<span class="token punctuation">;</span>
<span class="token keyword">USE</span> linuxd<span class="token punctuation">;</span>
source test<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="mysqldumpslow"><a href="#mysqldumpslow" class="header-anchor">#</a> mysqldumpslow</h2> <h3 id="常用参数-5"><a href="#常用参数-5" class="header-anchor">#</a> 常用参数</h3> <table><thead><tr><th>选项</th> <th>说明</th></tr></thead> <tbody><tr><td>-s</td> <td>ORDER what to sort by (al, at, ar, c, l, r, t), 'at' is default</td></tr> <tr><td></td> <td>排序方法，默认是at，按平均查询时间由高到低排序。</td></tr> <tr><td>-r</td> <td>reverse the sort order (largest last instead of first)</td></tr> <tr><td></td> <td>逆向排序</td></tr> <tr><td>-t</td> <td>NUM just show the top n queries</td></tr> <tr><td></td> <td>只显示前n个结果</td></tr> <tr><td>-a</td> <td>don't abstract all numbers to N and strings to 'S'</td></tr> <tr><td></td> <td>不合并结果中的具体数字和字符串为N和S</td></tr> <tr><td>-n</td> <td>NUM abstract numbers with at least n digits within names</td></tr> <tr><td></td> <td>至少合并n个数字</td></tr> <tr><td>-g</td> <td>PATTERN grep: only consider stmts that include this string</td></tr> <tr><td></td> <td>字符串过滤，grep</td></tr> <tr><td>-h</td> <td>HOSTNAME hostname of db server for <em>-slow.log filename (can be wildcard), default is '</em>', i.e. match all</td></tr> <tr><td></td> <td>指定服务器地址</td></tr></tbody></table> <h3 id="用法"><a href="#用法" class="header-anchor">#</a> 用法</h3> <p><strong>查看查询结果(Rows)最多的10个查询</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqldumpslow <span class="token parameter variable">-s</span> ar <span class="token parameter variable">-t</span> <span class="token number">10</span> /u01/mysql-5.6.39/log/slow.log
</code></pre></div><p><strong>查看锁的时间(Lock)最多的10个查询</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqldumpslow <span class="token parameter variable">-s</span> al <span class="token parameter variable">-t</span> <span class="token number">10</span> /u01/mysql-5.6.39/log/slow.log
</code></pre></div><p><strong>查看查询时间最长的10个查询</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqldumpslow <span class="token parameter variable">-s</span> at <span class="token parameter variable">-t</span> <span class="token number">10</span> /u01/mysql-5.6.39/log/slow.log
</code></pre></div><p><strong>查看查询时间最长的10个查询</strong></p> <p>不合并输出结果中具体的数字和字符串为 <code>N</code> 和 <code>S</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqldumpslow <span class="token parameter variable">-a</span> <span class="token parameter variable">-s</span> at <span class="token parameter variable">-t</span> <span class="token number">10</span> /u01/mysql-5.6.39/log/slow.log
</code></pre></div><h2 id="mysqld-safe"><a href="#mysqld-safe" class="header-anchor">#</a> mysqld_safe</h2> <h3 id="常用参数-6"><a href="#常用参数-6" class="header-anchor">#</a> 常用参数</h3> <table><thead><tr><th>选项</th> <th>说明</th></tr></thead> <tbody><tr><td>--defaults-file=file</td> <td>Use the specified defaults file</td></tr> <tr><td></td> <td>指定启动服务时使用的配置文件，通常是必选参数</td></tr> <tr><td>--open-files-limit=limit</td> <td>Limit the number of open files</td></tr> <tr><td></td> <td>指定MySQL服务可以打开的最大文件数，可以把它加到my.cnf 里，这里就不需要指定了。这个值在CentOS6里会传递给ulimit -n ，但是在7里面 limit 机制发生了改变，无需传递，直接由服务自己定义并生效</td></tr> <tr><td>--timezone=TZ</td> <td>Set the system timezone</td></tr> <tr><td></td> <td>指定服务使用的timezone，也可以加到配置文件的[mysqld_safe]下</td></tr> <tr><td>--malloc-lib=lib</td> <td>Preload shared library LIB if available</td></tr> <tr><td></td> <td>指定一个内存分配器，一般是jemalloc或tcmalloc(需要事先安装)，也可以加到配置文件的[mysqld_safe]下</td></tr> <tr><td>--mysqld=file</td> <td>Use the specified file as mysqld</td></tr> <tr><td></td> <td>指定mysqld的位置</td></tr> <tr><td>--syslog</td> <td>Log messages to syslog with 'logger'</td></tr> <tr><td></td> <td>使用系统的日志机制，把日志输出到/var/log/message，如果使用这个参数，需要取消配置文件里的log_error选项，两者冲突</td></tr> <tr><td>--skip-syslog</td> <td>Log messages to error log (default)</td></tr> <tr><td></td> <td>不使用系统的日志，MySQL默认选项</td></tr></tbody></table> <h3 id="常见用法-5"><a href="#常见用法-5" class="header-anchor">#</a> 常见用法</h3> <p>安全启动 <code>MySQL</code> 服务，命令需要以 <code>root</code> 权限执行，执行后调用实际的 <code>MySQL</code> 守护进程 <code>mysqld</code> 来启动服务，并使用<code>my.cnf</code> 里的配置选项。一般把选项都写到配置文件里然后执行</p> <p>在执行命令之前，如果配置文件里指定了 <code>err.log</code> 或者 <code>socket</code> 路径，必须要确保这些路径的目录或文件要存在，且用户和权限正确，否则命令报错</p> <div class="language-bash extra-class"><pre class="language-bash"><code>mysqld_safe --defaults-file<span class="token operator">=</span>/multi/3306/my.cnf <span class="token operator">&gt;</span> /dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>
</code></pre></div><h2 id="mysqlshow"><a href="#mysqlshow" class="header-anchor">#</a> mysqlshow</h2> <h3 id="常用参数-7"><a href="#常用参数-7" class="header-anchor">#</a> 常用参数</h3> <p>与 <a href="#mysqladmin">mysqladmin</a> 基本相同</p> <h3 id="常见用法-6"><a href="#常见用法-6" class="header-anchor">#</a> 常见用法</h3> <p>在多实例服务端执行命令时，要指定 <code>--socket=</code>
在远程连接服务端执行命令时，要指定 <code>--host=</code> 和 <code>--port=</code>
在单实例默认安装的服务端执行命令时，不需要指定 <code>--socket=</code> 或者 <code>--host=</code> <code>--port=</code></p> <p>下面示例以单实例服务端为例</p> <p>查看数据库，等同于 <code>SQL</code> 语句 <code>SHOW DATABASES;</code></p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysqlshow <span class="token operator">-</span>uroot <span class="token operator">-</span>p
<span class="token operator">+</span><span class="token comment">--------------------+</span>
<span class="token operator">|</span>     <span class="token keyword">Databases</span>      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------+</span>
<span class="token operator">|</span> information_schema <span class="token operator">|</span>
<span class="token operator">|</span> linuxd             <span class="token operator">|</span>
<span class="token operator">|</span> linuxd1            <span class="token operator">|</span>
<span class="token operator">|</span> mysql              <span class="token operator">|</span>
<span class="token operator">|</span> performance_schema <span class="token operator">|</span>
<span class="token operator">|</span> typecho            <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------+</span>
</code></pre></div><p>查看数据库 <code>linuxd</code> 下有哪些表</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysqlshow <span class="token operator">-</span>uroot <span class="token operator">-</span>p linuxd
<span class="token keyword">Database</span>: linuxd
<span class="token operator">+</span><span class="token comment">--------+</span>
<span class="token operator">|</span> <span class="token keyword">Tables</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------+</span>
<span class="token operator">|</span> test   <span class="token operator">|</span>
<span class="token operator">|</span> test1  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------+</span>
</code></pre></div><p>统计数据库 <code>linuxd</code> 下表中列的数量</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysqlshow <span class="token operator">-</span>uroot <span class="token operator">-</span>p linuxd <span class="token operator">-</span>v
<span class="token keyword">Database</span>: linuxd
<span class="token operator">+</span><span class="token comment">--------+----------+</span>
<span class="token operator">|</span> <span class="token keyword">Tables</span> <span class="token operator">|</span> <span class="token keyword">Columns</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------+----------+</span>
<span class="token operator">|</span> test   <span class="token operator">|</span>        <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> test1  <span class="token operator">|</span>        <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------+----------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span><span class="token punctuation">.</span>
</code></pre></div><p>统计数据库 <code>linuxd</code> 下表中字段的数量和数据的行数</p> <div class="language-sql extra-class"><pre class="language-sql"><code>mysqlshow <span class="token operator">-</span>uroot <span class="token operator">-</span>p linuxd <span class="token operator">-</span>v <span class="token operator">-</span>v
<span class="token keyword">Database</span>: linuxd
<span class="token operator">+</span><span class="token comment">--------+----------+------------+</span>
<span class="token operator">|</span> <span class="token keyword">Tables</span> <span class="token operator">|</span> <span class="token keyword">Columns</span>  <span class="token operator">|</span> Total <span class="token keyword">Rows</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------+----------+------------+</span>
<span class="token operator">|</span> test   <span class="token operator">|</span>        <span class="token number">3</span> <span class="token operator">|</span>          <span class="token number">8</span> <span class="token operator">|</span>
<span class="token operator">|</span> test1  <span class="token operator">|</span>        <span class="token number">3</span> <span class="token operator">|</span>          <span class="token number">0</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------+----------+------------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span><span class="token punctuation">.</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/MySQL/variables.html" class="prev">
        参数
      </a></span> <span class="next"><a href="/MySQL/sql.html">
        SQL
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.6ea617b8.js" defer></script><script src="/assets/js/2.6e381248.js" defer></script><script src="/assets/js/35.1d02fd3c.js" defer></script>
  </body>
</html>
