(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{214:function(a,t,s){"use strict";s.r(t);var e=s(6),r=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"ftp-sever"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ftp-sever"}},[a._v("#")]),a._v(" FTP Sever")]),a._v(" "),t("h2",{attrs:{id:"工作模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#工作模式"}},[a._v("#")]),a._v(" 工作模式")]),a._v(" "),t("p",[t("strong",[a._v("主动模式")])]),a._v(" "),t("ul",[t("li",[a._v("命令连接：客户端 >1023端口 -> 服务器 21端口")]),a._v(" "),t("li",[a._v("数据连接：客户端 >1023端口 <- 服务器 20端口")])]),a._v(" "),t("p",[t("strong",[a._v("被动模式")])]),a._v(" "),t("ul",[t("li",[a._v("命令连接：客户端 >1023端口 -> 服务器 21端口")]),a._v(" "),t("li",[a._v("数据连接：客户端 >1023端口 -> 服务器 >1023端口")])]),a._v(" "),t("p",[a._v("参考："),t("a",{attrs:{href:"https://www.cnblogs.com/xiaohh/p/4789813.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://www.cnblogs.com/xiaohh/p/4789813.html"),t("OutboundLink")],1)]),a._v(" "),t("h2",{attrs:{id:"配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置文件"}},[a._v("#")]),a._v(" 配置文件")]),a._v(" "),t("table",[t("thead",[t("tr",[t("th",[a._v("配置文件")]),a._v(" "),t("th",[a._v("说明")])])]),a._v(" "),t("tbody",[t("tr",[t("td",[a._v("/etc/vsftpd/vsftpd.conf")]),a._v(" "),t("td",[a._v("主配置文件")])]),a._v(" "),t("tr",[t("td",[a._v("/etc/vsftpd/ftpusers")]),a._v(" "),t("td",[a._v("黑名单")])]),a._v(" "),t("tr",[t("td",[a._v("/etc/vsftpd/vsftpd_conf_migrate.sh")]),a._v(" "),t("td",[a._v("迁移脚本")])]),a._v(" "),t("tr",[t("td",[a._v("/etc/vsftpd/user_list")]),a._v(" "),t("td",[a._v("用户列表，与userlist_enbale和userlist_deny选项密切相关")])])])]),a._v(" "),t("h2",{attrs:{id:"安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[a._v("#")]),a._v(" 安装")]),a._v(" "),t("p",[a._v("安装 "),t("code",[a._v("vsftpd")]),a._v(" 以及 "),t("code",[a._v("Berkeley DB")]),a._v(" (用于生成虚拟用户认证文件)")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("yum "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" vsftpd\nyum "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" libdb-utils      "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#CentOS7是libdb-utils")]),a._v("\nyum "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" db4 db4-utils    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#CentOS6是db4-utils")]),a._v("\n")])])]),t("h2",{attrs:{id:"宿主用户"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#宿主用户"}},[a._v("#")]),a._v(" 宿主用户")]),a._v(" "),t("p",[a._v("创建宿主用户，即 "),t("code",[a._v("guest_username")]),a._v(" ，所有虚拟用户都是映射宿主用户的目录权限。")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("useradd")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" /var/vsftp "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" /sbin/nologin vsftp\n")])])]),t("h2",{attrs:{id:"主配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#主配置文件"}},[a._v("#")]),a._v(" 主配置文件")]),a._v(" "),t("div",{staticClass:"language-ini extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# /etc/vsftpd/vsftpd.conf")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#关闭匿名访问")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("anonymous_enable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NO")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#启用本地系统用户，包括虚拟用户")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("local_enable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#允许执行FTP命令，如果禁用，将不能进行上传、下载、删除、重命名等操作")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("write_enable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#本地用户umask值")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("local_umask")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("022")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("dirmessage_enable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#启用日志")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("xferlog_enable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("xferlog_std_format")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#关闭ftp-data端口，相当于不使用主动模式")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("connect_from_port_20")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NO")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#限制用户不能离开FTP主目录，启用并设置例外用户清单")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("chroot_local_user")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("chroot_list_enable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("chroot_list_file")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/etc/vsftpd/chroot_list")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#使用ipv4进行监听")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("listen")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("listen_ipv6")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NO")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#pam认证文件名称，位于/etc/pam.d/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("pam_service_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("vsftpd")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#启用全局用户例外清单")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("userlist_enable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#启用tcp封装")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("tcp_wrappers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#虚拟用户权限是否与本地用户相同。为NO时，将与匿名用户的权限相同，在每个虚拟用户配置文件里设置匿名用户的选项等于虚拟用户的权限")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("virtual_use_local_privs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NO")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#启用guest后，所有非匿名用户将映射到guest_username进行访问，包括本地系统用户也不能使用，并且转换成一个虚拟用户，与其他虚拟用户的配置方法一样")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("guest_enable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("guest_username")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("vsftp")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#虚拟用户配置文件目录")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("user_config_dir")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/etc/vsftpd/vuser_conf")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#启用pasv模式")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("pasv_enable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("YES")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("pasv_min_port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("33000")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("pasv_max_port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("34000")]),a._v("\n")])])]),t("p",[a._v("其他选项参考："),t("a",{attrs:{href:"https://security.appspot.com/vsftpd/vsftpd_conf.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://security.appspot.com/vsftpd/vsftpd_conf.html"),t("OutboundLink")],1)]),a._v(" "),t("h2",{attrs:{id:"chroot-list"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#chroot-list"}},[a._v("#")]),a._v(" chroot_list")]),a._v(" "),t("p",[t("code",[a._v("chroot()")]),a._v(" 会检查 "),t("code",[a._v("chroot_list")]),a._v(" 文件，如果没有，连接 "),t("code",[a._v("FTP")]),a._v(" 服务时会报错，提示找不到 "),t("code",[a._v("chroot_list")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("touch")]),a._v(" /etc/vsftpd/chroot_list\n")])])]),t("h2",{attrs:{id:"虚拟用户"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#虚拟用户"}},[a._v("#")]),a._v(" 虚拟用户")]),a._v(" "),t("p",[t("strong",[a._v("虚拟用户列表文件")])]),a._v(" "),t("p",[a._v("创建一个虚拟用户列表文件")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("/etc/vsftpd/vuser\n")])])]),t("p",[a._v("奇行为用户名，偶行为密码")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("ftpserver\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("111111")]),a._v("\n")])])]),t("p",[t("strong",[a._v("虚拟用户认证文件")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("db_load "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-T")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("hash")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" /etc/vsftpd/vuser /etc/vsftpd/vuser.db\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("600")]),a._v(" /etc/vsftpd/vuser.db\n")])])]),t("p",[t("strong",[a._v("虚拟用户认证配置")])]),a._v(" "),t("p",[a._v("在 "),t("code",[a._v("/etc/pam.d/vsftpd")]),a._v(" 中注释掉其他本地用户认证的内容，因为启用了 "),t("code",[a._v("guest_enable")]),a._v(" 后，本地用户将失效，所有非匿名用户变成虚拟用户")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# /etc/pam.d/vsftpd")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# system user")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#session    optional     pam_keyinit.so    force revoke")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#auth       required    pam_listfile.so item=user sense=deny file=/etc/vsftpd/ftpusers onerr=succeed")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#auth       required    pam_shells.so")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#auth       include     password-auth")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#account    include     password-auth")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#session    required     pam_loginuid.so")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#session    include     password-auth")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# virtual user")]),a._v("\nauth required /lib64/security/pam_userdb.so "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("db")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/etc/vsftpd/vuser\naccount required /lib64/security/pam_userdb.so "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("db")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/etc/vsftpd/vuser\n")])])]),t("p",[t("strong",[a._v("虚拟用户配置文件")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" /etc/vsftpd/vuser_conf/\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("touch")]),a._v(" /etc/vsftpd/vuser_conf/ftpserver\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# /etc/vsftpd/vuser_conf/ftpserver")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("local_root")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/var/vsftp/ftpserver\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("anon_umask")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("077\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("anon_world_readable_only")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("NO\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("anon_upload_enable")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("YES\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("anon_mkdir_write_enable")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("YES\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("anon_other_write_enable")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("YES\n")])])]),t("p",[a._v("其中虚拟用户的配置文件名称需要与 "),t("code",[a._v("/etc/vsftpd/vuser")]),a._v(" 中配置的用户名对应，此处为 "),t("code",[a._v("ftpserver")]),a._v(" ， "),t("code",[a._v("local_root")]),a._v(" 为当前虚拟用户的根目录，且属主和属组都必须为最开始创建的宿主用户 "),t("code",[a._v("vsftp")]),a._v(" 。在 "),t("code",[a._v("vsftpd")]),a._v(" 主配置文件中已经规定，虚拟用户权限取匿名用户的权限配置，因此这里配置的以 "),t("code",[a._v("anon")]),a._v(" 开头的选项都对应当前虚拟用户的权限。")]),a._v(" "),t("p",[t("strong",[a._v("虚拟用户主目录和权限")])]),a._v(" "),t("p",[a._v("最新版 "),t("code",[a._v("vsftpd")]),a._v(" 不允许用户主目录有 "),t("code",[a._v("w")]),a._v(" 权限，因此在主目录下新建一个子目录，赋予 "),t("code",[a._v("700")]),a._v(" 权限。所有上传、下载、删除、重命名等操作只能在子目录中进行")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" /var/vsftp/ftpserver/newdir\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("chown")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-R")]),a._v(" vsftp.vsftp /var/vsftp\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-R")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("500")]),a._v(" /var/vsftp\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-R")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("700")]),a._v(" /var/vsftp/ftpserver/newdir\n")])])]),t("p",[t("strong",[a._v("删除虚拟用户")])]),a._v(" "),t("p",[a._v("如果需要删除某个已经创建的虚拟用户，首先在 "),t("code",[a._v("/etc/vsftpd/vuser")]),a._v(" 中删除用户密码配置，然后在 "),t("code",[a._v("/etc/vsftpd/vuser_conf/")]),a._v(" 下删除对应虚拟用户的配置文件，最后删除 "),t("code",[a._v("/etc/vsftpd/vuser.db")]),a._v(" 重新创建认证文件，然后重启服务 "),t("code",[a._v("systemctl restart vsftpd.service")])]),a._v(" "),t("h2",{attrs:{id:"selinux"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#selinux"}},[a._v("#")]),a._v(" SELINUX")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("setsebool "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-P")]),a._v(" ftpd_full_access on\n")])])]),t("h2",{attrs:{id:"防火墙"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#防火墙"}},[a._v("#")]),a._v(" 防火墙")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("iptables "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-I")]),a._v(" INPUT "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" tcp "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dport")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("21")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-j")]),a._v(" ACCEPT\niptables "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-I")]),a._v(" INPUT "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" tcp "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--dport")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("33000")]),a._v(":34000 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-j")]),a._v(" ACCEPT\niptables-save "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("/etc/sysconfig/iptables\n")])])]),t("h2",{attrs:{id:"重启"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#重启"}},[a._v("#")]),a._v(" 重启")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("systemctl restart vsftpd.service\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);