(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{244:function(t,s,a){"use strict";a.r(s);var r=a(6),e=Object(r.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"mysql-innodb-cluster"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mysql-innodb-cluster"}},[t._v("#")]),t._v(" MySQL innodb cluster")]),t._v(" "),s("h2",{attrs:{id:"版本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#版本"}},[t._v("#")]),t._v(" 版本")]),t._v(" "),s("ul",[s("li",[t._v("MySQL：8.0.26")]),t._v(" "),s("li",[t._v("mysql-shell：8.0.26")]),t._v(" "),s("li",[t._v("mysql-router：8.0.26")])]),t._v(" "),s("h2",{attrs:{id:"规划"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#规划"}},[t._v("#")]),t._v(" 规划")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("服务")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("IP")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("MySQL-Router")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("centos1(192.168.1.5)")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("Mysql Server、Mysql Shell")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("mysql1(192.168.1.6)")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("Mysql Server、Mysql Shell")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("mysql2(192.168.1.8)")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[t._v("Mysql Server、Mysql Shell")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("mysql3(192.168.1.10)")])])])]),t._v(" "),s("h2",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[t._v("#")]),t._v(" 安装")]),t._v(" "),s("p",[t._v("安装"),s("code",[t._v("mysql-community-server")]),t._v("和"),s("code",[t._v("mysql-shell")])]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("yum "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" mysql-community-server mysql-shell\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("touch")]),t._v(" /var/log/slowquery.log\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("chown")]),t._v(" mysql. /var/log/slowquery.log\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" /etc/security/limits.d/20-nproc.conf\nmysql soft nproc "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("65536")]),t._v("\nmysql hard nproc "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("65536")]),t._v("\nmysql soft nofile "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("65536")]),t._v("\nmysql hard nofile "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("65536")]),t._v("\n")])])]),s("h2",{attrs:{id:"设置系统hosts"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设置系统hosts"}},[t._v("#")]),t._v(" 设置系统hosts")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vi /etc/hosts")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".1.5 centos1\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".1.6 mysql1\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".1.8 mysql2\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".1.10 mysql3\n")])])]),s("h2",{attrs:{id:"开放需要的端口"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#开放需要的端口"}},[t._v("#")]),t._v(" 开放需要的端口")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("iptables "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-I")]),t._v(" INPUT "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" tcp "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--dport")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-j")]),t._v(" ACCEPT\niptables "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-I")]),t._v(" INPUT "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" tcp "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--dport")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("13306")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-j")]),t._v(" ACCEPT\niptables "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-I")]),t._v(" INPUT "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" tcp "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--dport")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("33061")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-j")]),t._v(" ACCEPT\niptables "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-I")]),t._v(" INPUT "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" tcp "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--dport")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("33060")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-j")]),t._v(" ACCEPT\niptables-save "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /etc/sysconfig/iptables\n")])])]),s("h2",{attrs:{id:"配置my-cnf"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置my-cnf"}},[t._v("#")]),t._v(" 配置my.cnf")]),t._v(" "),s("p",[t._v("需要修改的配置如下：")]),t._v(" "),s("ul",[s("li",[t._v("server_id")]),t._v(" "),s("li",[t._v("bind-address")])]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[t._v("[mysql]\ndefault-character-set=utf8\nno-auto-rehash\nprompt=\\\\u@\\\\d \\\\R:\\\\m>\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#socket = /var/lib/mysql/mysql.sock")]),t._v("\n\n[mysqld]\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("############### base ############")]),t._v("\nport = 3306 \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#basedir = /webser/mysql57")]),t._v("\ndatadir = /var/lib/mysql\nsocket = /var/lib/mysql/mysql.sock\npid-file = /var/run/mysqld/mysqld.pid\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#tmpdir = /tmp #default ")]),t._v("\nskip-external-locking\ntransaction_isolation = REPEATABLE-READ\ndefault-storage-engine = InnoDB\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#skip-name-resolve")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#event-scheduler = ON")]),t._v("\ndefault-time-zone='+8:00'\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#extra_port = ")]),t._v("\nsql_mode=NO_ENGINE_SUBSTITUTION\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#explicit_defaults_for_timestamp = 1 #Deprecated 5.6.6")]),t._v("\nopen_files_limit = 65535\n\nevent_scheduler = 0\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("############### connections ############")]),t._v("\nback_log = 500\nmax_connections = 10000\nmax_user_connections = 980\nmax_connect_errors = 50\ntable_open_cache = 3000\ntable_definition_cache = 1000\nmax_allowed_packet = 512M\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#concurrency ")]),t._v("\nthread_cache_size = 500 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# for master")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("################# timeout ###########")]),t._v("\nconnect_timeout = 10\ninteractive_timeout = 3600\nwait_timeout = 3600\nnet_read_timeout = 30\nnet_write_timeout = 60\nnet_retry_count = 10\n\nlock_wait_timeout = 60 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 1 minutes")]),t._v("\ninnodb_lock_wait_timeout = 60 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 1 minutes")]),t._v("\ninnodb_rollback_on_timeout = 1\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#innodb_print_all_deadlocks #since 5.6.2")]),t._v("\nmax_write_lock_count = 100000\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("###########  character set ###############")]),t._v("\ncharacter-set-server = utf8\ncollation-server = utf8_general_ci\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#default-character-set=utf8")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("########### log #################")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#error log")]),t._v("\nlog-error = /var/log/mysqld.log\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#log-warnings = 2")]),t._v("\nlog_timestamps = SYSTEM\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#slow log")]),t._v("\nslow-query-log\nslow_query_log_file = /var/log/slowquery.log\nlong_query_time = 1\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#log-queries-not-using-indexes = 1")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#binlog")]),t._v("\nbinlog-format = ROW\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#binlog_rows_query_log_events = 1")]),t._v("\nlog-bin\nbinlog_checksum = NONE  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#innodb cluster 新加选项")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#log-bin-index = ")]),t._v("\nlog-bin-trust-function-creators = 1\nexpire_logs_days = 14\nmax_binlog_size = 512M\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#sync_binlog = 1")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#binlog_cache_size = 33554432 #32M default 32K")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#binlog_stmt_cache_size= 2097152 #2M default 32K")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#relaylog")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#relay-log = ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#sync_relay_log = 1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#sync_relay_log_info = 1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#relay-log-info-file = ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#relay_log_recovery = 1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#relay_log_space_limit = 0")]),t._v("\nrelay_log_purge = 1\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("############## replication ##########")]),t._v("\nread_only = 0\nskip_slave_start = 1\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#master-info-file = ")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#sync_master_info = 1")]),t._v("\nslave_transaction_retries = 60\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#replicate_do_db = stock_data")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#replicate_wild_do_table = stock_data.%")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#log_slow_slave_statements = 0")]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("###############tmp/memory table restriction ###########")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#max_heap_table_size = 512M")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#tmp_table_size = 512M")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("########## memory ################")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#key_buffer_size = 1G #myisam")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#innodb_buffer_pool_size = 40G #for total 64G")]),t._v("\ninnodb_buffer_pool_size = 1G\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#innodb_additional_mem_pool_size = 16M")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#innodb_buffer_pool_instances = 10")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#innodb_log_buffer_size = 16M")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#thread_stack = 256K #per thread")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#sort_buffer_size = 16M # per connection")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#join_buffer_size = 16M   # per connection per join")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#read_buffer_size = 16M      #per connection")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#read_rnd_buffer_size = 32M  #per connection")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("############# innodb settings #################")]),t._v("\ninnodb_force_recovery = 0\ninnodb_flush_log_at_trx_commit = 0\ninnodb_flush_method = O_DIRECT\ninnodb_read_io_threads = 4\ninnodb_write_io_threads = 4\ninnodb_thread_concurrency = 0\ninnodb_doublewrite = 1\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#innodb_checksum_algorithm=innodb #Introduced 5.6.3")]),t._v("\ninnodb_autoinc_lock_mode = 2\ninnodb_change_buffering = all\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#innodb_file_format = Barracuda #Deprecated 5.7.7")]),t._v("\ninnodb_file_per_table = 1\ninnodb_data_file_path = ibdata1:1G:autoextend\ninnodb_autoextend_increment = 100\ninnodb_log_files_in_group = 2\ninnodb_log_file_size = 1G\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#innodb_ft_min_token_size = 1 #Introduced 5.6.4")]),t._v("\ninnodb_open_files = 10240\ninnodb_max_dirty_pages_pct = 75 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#default 75")]),t._v("\ninnodb_old_blocks_time = 1000 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# >= 5.6.6 default 1000 <= 5.6.5 default 0")]),t._v("\ninnodb_old_blocks_pct = 37 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#default 37")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#innodb_stats_persistent = 1 #Introduced 5.6.6")]),t._v("\ninnodb_stats_on_metadata = 0\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#innodb_online_alter_log_max_size = 134217728 #Introduced 5.6.6 default 134217728")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("############ others ############")]),t._v("\nft_min_word_len = 1\ngroup_concat_max_len = 2048\nlower_case_table_names = 1\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("############## innodb cluster ##########")]),t._v("\nserver-id = 101 \nbind-address = mysql1\ngtid_mode = ON\nenforce_gtid_consistency = ON\nlog_slave_updates = ON\nmaster_info_repository = TABLE\nrelay_log_info_repository = TABLE\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#server必须为每个事务收集写集合，并使用XXHASH64哈希算法将其编码为散列")]),t._v("\ntransaction_write_set_extraction=XXHASH64\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#dba.checkInstanceConfiguration() 检查出来的选项")]),t._v("\nbinlog_transaction_dependency_tracking=WRITESET\nreplica_parallel_type=LOGICAL_CLOCK\nreplica_preserve_commit_order=ON\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#告知插件加入或创建组命名，UUID,集群中UUID一致，mysqld.log里查找")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#loose-group_replication_group_name="d4f17739-0fbb-11ec-84e5-000c298e6c6c"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#server启动时不自启组复制,为了避免每次启动自动引导具有相同名称的第二个组,所以设置为OFF。")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#loose-group_replication_start_on_boot=off")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#告诉插件使用IP地址，端口24901用于接收组中其他成员转入连接")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#loose-group_replication_local_address= "mysql01:3306"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#启动组server，种子server，加入组应该连接这些的ip和端口；其他server要加入组得由组成员同意")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#loose-group_replication_group_seeds="mysql01:3306,mysql02:3306,mysql03:3306"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#loose-group_replication_ip_whitelist="mysql01,mysql02,mysql03"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#loose-group_replication_bootstrap_group = off")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#loose-group_replication_allow_local_disjoint_gtids_join = ON")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用MGR的单主模式")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#loose-group_replication_single_primary_mode = on")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#loose-group_replication_enforce_update_everywhere_checks = off")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 禁止其他引擎创建库表")]),t._v("\ndisabled_storage_engines = MyISAM,BLACKHOLE,FEDERATED,CSV,ARCHIVE\n")])])]),s("h2",{attrs:{id:"设置mysql用户"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设置mysql用户"}},[t._v("#")]),t._v(" 设置MySQL用户")]),t._v(" "),s("p",[t._v("启动MySQL后修改密码")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ALTER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("USER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root'")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@'localhost'")]),t._v(" IDENTIFIED "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Abc@123456'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nflush "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("privileges")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("添加集群需要的账号")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("USER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root'")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@'192.168.1.5'")]),t._v(" IDENTIFIED "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Abc@123456'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("USER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root'")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@'192.168.1.6'")]),t._v(" IDENTIFIED "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Abc@123456'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("USER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root'")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@'192.168.1.8'")]),t._v(" IDENTIFIED "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Abc@123456'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("USER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root'")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@'192.168.1.10'")]),t._v(" IDENTIFIED "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Abc@123456'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GRANT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ALL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PRIVILEGES")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TO")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root'")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@'192.168.1.5'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WITH")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GRANT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OPTION")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GRANT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ALL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PRIVILEGES")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TO")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root'")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@'192.168.1.6'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WITH")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GRANT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OPTION")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GRANT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ALL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PRIVILEGES")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TO")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root'")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@'192.168.1.8'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WITH")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GRANT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OPTION")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GRANT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ALL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PRIVILEGES")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TO")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root'")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@'192.168.1.10'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WITH")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GRANT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OPTION")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nflush "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("privileges")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("USER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root'")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@'%'")]),t._v(" IDENTIFIED "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Abc@123456'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GRANT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ALL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PRIVILEGES")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TO")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root'")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@'%'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WITH")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GRANT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OPTION")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nflush "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("privileges")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"配置创建innodb-cluster集群"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置创建innodb-cluster集群"}},[t._v("#")]),t._v(" 配置创建Innodb Cluster集群")]),t._v(" "),s("h3",{attrs:{id:"持久化集群配置文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#持久化集群配置文件"}},[t._v("#")]),t._v(" 持久化集群配置文件")]),t._v(" "),s("p",[s("strong",[s("u",[t._v("所有集群节点都需要执行")])]),t._v(" ，以下是mysql1上的示例，mysql2和mysql3上执行相同的操作，相当于初始化MySQL集群实例")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("mysqlsh "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("uri root@mysql1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("\nPlease provide the password "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root@mysql1:3306'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v("\nSave password "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root@mysql1:3306'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("Y")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("es"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("N")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("o"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Ne"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("v"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("er")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" No"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" y\nMySQL Shell "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.0")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".26")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Copyright")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2016")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Oracle and"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("or its affiliates"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nOracle is a registered trademark "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v(" Oracle Corporation and"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("or its affiliates"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nOther names may be trademarks "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v(" their respective owners"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\nType "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\help'")]),t._v(" or "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\?'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" help"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\quit'")]),t._v(" to exit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nCreating a session to "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root@mysql1:3306'")]),t._v("\nFetching schema names "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" autocompletion"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v(" Press "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("C")]),t._v(" to stop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nYour MySQL connection id is "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\nServer version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.0")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".26")]),t._v(" MySQL Community Server "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GPL")]),t._v("\nNo "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" schema selected"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" type \\use "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("schema"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" to "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" one"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\nMySQL  mysql1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v(" ssl  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" dba"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("configureLocalInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nConfiguring local MySQL instance listening at port "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" use "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" an InnoDB cluster"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n\nThis instance reports its own address "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("mysql1")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("\nClients and other cluster members will communicate "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" it through "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),t._v(" address by "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" If "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),t._v(" is not correct"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" the report_host MySQL system variable should be changed"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\napplierWorkerThreads will be "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" to the "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" value "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4.")]),t._v("\n\nThe instance "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql1:3306'")]),t._v(" is valid to be used "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" an InnoDB cluster"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nThe instance "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql1:3306'")]),t._v(" is already ready to be used "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" an InnoDB cluster"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\nMySQL  mysql1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v(" ssl  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" dba"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("checkInstanceConfiguration")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nValidating local MySQL instance listening at port "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" use "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" an InnoDB cluster"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n\nThis instance reports its own address "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("mysql1")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("\nClients and other cluster members will communicate "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" it through "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),t._v(" address by "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" If "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),t._v(" is not correct"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" the report_host MySQL system variable should be changed"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\nChecking whether existing tables comply "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" Group Replication requirements"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\nNo incompatible tables detected\n\nChecking instance configuration"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\nInstance configuration is compatible "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" InnoDB cluster\n\nThe instance "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql1:3306'")]),t._v(" is valid to be used "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" an InnoDB cluster"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"status"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ok"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"在管理节点mysql1上创建集群"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在管理节点mysql1上创建集群"}},[t._v("#")]),t._v(" 在管理节点"),s("code",[t._v("mysql1")]),t._v("上创建集群")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("mysqlsh "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("uri root@mysql1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("\n\nMySQL  mysql1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v(" ssl  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" cluster "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" dba"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createCluster")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dev'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("A")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InnoDB")]),t._v(" cluster will be created on instance "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql1:3306'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\nValidating instance configuration at mysql1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306.")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\nThis instance reports its own address "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("mysql1")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("\n\nInstance configuration is suitable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NOTE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Group Replication will communicate "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" other members using "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql1:33061'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" Use the localAddress option to override"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\nCreating InnoDB cluster "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dev'")]),t._v(" on "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql1:3306'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n\nAdding Seed Instance"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\nCluster successfully created"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" Use Cluster"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" to add MySQL instances"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nAt least "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" instances are needed "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" the cluster to be able to withstand up to\none server failure"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\n MySQL  mysql1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v(" ssl  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" cluster"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("status")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"clusterName"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dev"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"defaultReplicaSet"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"default"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"primary"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysql1:3306"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"ssl"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"REQUIRED"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"status"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"OK_NO_TOLERANCE"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"statusText"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Cluster is NOT tolerant to any failures."')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"topology"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"mysql1:3306"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"address"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysql1:3306"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"memberRole"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"PRIMARY"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"mode"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"R/W"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"readReplicas"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"replicationLag"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"role"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HA"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"status"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ONLINE"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8.0.26"')]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"topologyMode"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Single-Primary"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"groupInformationSourceMember"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysql1:3306"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"把mysql2添加到集群-mysql3以此类推"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#把mysql2添加到集群-mysql3以此类推"}},[t._v("#")]),t._v(" 把mysql2添加到集群，mysql3以此类推")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v(" MySQL  mysql1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v(" ssl  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" cluster"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root@mysql2:3306'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NOTE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" The target instance "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql2:3306'")]),t._v(" has not been pre"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("provisioned")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GTID")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" is empty"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" The Shell is unable to decide whether incremental state recovery can correctly provision it"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nThe safest and most convenient way to provision a "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("instance")]),t._v(" is through automatic clone provisioning"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" which will completely overwrite the state "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql2:3306'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" a physical snapshot from an existing cluster member"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" To use "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),t._v(" method by "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" the "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'recoveryMethod'")]),t._v(" option to "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'clone'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\nThe incremental state recovery may be safely used "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" you are sure all updates ever executed "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" the cluster were done "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" GTIDs enabled"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" there are no purged transactions and the "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("instance")]),t._v(" contains the same "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GTID")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" the cluster or a subset "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v(" it"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" To use "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),t._v(" method by "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" the "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'recoveryMethod'")]),t._v(" option to "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'incremental'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\n\nPlease select a recovery method "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("C")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("lone"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("I")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("ncremental recovery"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("A")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("bort")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" Clone"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" \nValidating instance configuration at mysql2"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306.")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\nThis instance reports its own address "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("mysql2")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("\n\nInstance configuration is suitable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NOTE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Group Replication will communicate "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" other members using "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql2:33061'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" Use the localAddress option to override"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("A")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("instance")]),t._v(" will be added to the InnoDB cluster"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" Depending on the amount "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v("\ndata on the cluster "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),t._v(" might take from a few seconds to several hours"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\nAdding instance to the cluster"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n\nMonitoring recovery process "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v(" the "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("cluster")]),t._v(" member"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" Press "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("C")]),t._v(" to stop monitoring and "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" it "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("continue")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" background"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nClone based state recovery is now "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" progress"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NOTE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("A")]),t._v(" server restart is expected to happen "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" part "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v(" the clone process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" If the\nserver does not support the "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("RESTART")]),t._v(" command or does not come back after a\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" you may need to manually start it back"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" Waiting "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" clone to finish"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NOTE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" mysql2"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v(" is being cloned from mysql1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v(" Stage "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DROP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DATA")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Completed\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v(" Clone Transfer  \n    "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("FILE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("COPY")]),t._v("  ############################################################  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("  Completed\n    "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PAGE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("COPY")]),t._v("  ############################################################  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("  Completed\n    "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("REDO")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("COPY")]),t._v("  ############################################################  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("  Completed\n\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NOTE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" mysql2"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v(" is shutting down"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" Waiting "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" server restart"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v(" ready\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" mysql2"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v(" has restarted"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" waiting "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" clone to finish"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v(" Stage "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("RESTART")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Completed\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" Clone process has finished"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.13")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GB")]),t._v(" transferred "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sec")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("377.79")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("MB")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nIncremental state recovery is now "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" progress"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" Waiting "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" distributed recovery to finish"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NOTE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql2:3306'")]),t._v(" is being recovered "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<NULL>:0'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" Distributed recovery has finished\n\nThe instance "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql2:3306'")]),t._v(" was successfully added to the cluster"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),s("h3",{attrs:{id:"查看集群状态"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看集群状态"}},[t._v("#")]),t._v(" 查看集群状态")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v(" MySQL  mysql1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v(" ssl  "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" cluster"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("status")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"clusterName"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dev"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"defaultReplicaSet"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"default"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"primary"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysql1:3306"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"ssl"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"REQUIRED"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"status"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"OK"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"statusText"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Cluster is ONLINE and can tolerate up to ONE failure."')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"topology"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"mysql1:3306"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"address"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysql1:3306"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"memberRole"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"PRIMARY"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"mode"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"R/W"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"readReplicas"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"replicationLag"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"role"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HA"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"status"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ONLINE"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8.0.26"')]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n            "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"mysql2:3306"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"address"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysql2:3306"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"memberRole"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SECONDARY"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"mode"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"R/O"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"readReplicas"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"replicationLag"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"role"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HA"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"status"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ONLINE"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8.0.26"')]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n            "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"mysql3:3306"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"address"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysql3:3306"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"memberRole"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SECONDARY"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"mode"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"R/O"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"readReplicas"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"replicationLag"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"role"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"HA"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"status"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ONLINE"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8.0.26"')]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"topologyMode"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Single-Primary"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"groupInformationSourceMember"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysql1:3306"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"cluster操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cluster操作"}},[t._v("#")]),t._v(" cluster操作")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("操作")]),t._v(" "),s("th",[t._v("方法示例")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("连接实例")]),t._v(" "),s("td",[s("code",[t._v("\\connect root@192.168.15.98:3306")])])]),t._v(" "),s("tr",[s("td",[t._v("检测实例状态")]),t._v(" "),s("td",[s("code",[t._v("dba.checkInstanceConfiguration('root@192.168.15.98:3306')")])])]),t._v(" "),s("tr",[s("td",[t._v("自动修正实例设置")]),t._v(" "),s("td",[s("code",[t._v("dba.configureInstance('root@192.168.15.98:3306')")])])]),t._v(" "),s("tr",[s("td",[t._v("删除集群元数据")]),t._v(" "),s("td",[s("code",[t._v("dba.dropMetadataSchema()")])])]),t._v(" "),s("tr",[s("td",[t._v("创建集群")]),t._v(" "),s("td",[s("code",[t._v("var cluster = dba.createCluster('clusterTest')")])])]),t._v(" "),s("tr",[s("td",[t._v("向集群中添加实例")]),t._v(" "),s("td",[s("code",[t._v("cluster.addInstance('root@192.168.15.38:3306')")])])]),t._v(" "),s("tr",[s("td",[t._v("从集群中删除实例")]),t._v(" "),s("td",[s("code",[t._v("cluster.removeInstance('root@192.168.15.38:3306')")])])]),t._v(" "),s("tr",[s("td",[t._v("从集群中删除实例（强制）")]),t._v(" "),s("td",[s("code",[t._v("cluster.removeInstance('root@192.168.15.38:3306',{force:true})")])])]),t._v(" "),s("tr",[s("td",[t._v("查看集群状态")]),t._v(" "),s("td",[s("code",[t._v("cluster.status()")])])]),t._v(" "),s("tr",[s("td",[t._v("查看集群描述")]),t._v(" "),s("td",[s("code",[t._v("cluster.describe()")])])]),t._v(" "),s("tr",[s("td",[t._v("重启集群")]),t._v(" "),s("td",[s("code",[t._v("var cluster = dba.rebootClusterFromCompleteOutage()")])])]),t._v(" "),s("tr",[s("td",[t._v("解散集群")]),t._v(" "),s("td",[s("code",[t._v("cluster.dissolve({force:true})")])])]),t._v(" "),s("tr",[s("td",[t._v("指定一个新的主节点")]),t._v(" "),s("td",[s("code",[t._v("cluster.setPrimaryInstance('root@192.168.15.38:3306')")])])]),t._v(" "),s("tr",[s("td",[t._v("切换到多主模式")]),t._v(" "),s("td",[s("code",[t._v("cluster.switchToMultiPrimaryMode()")])])]),t._v(" "),s("tr",[s("td",[t._v("切换到单主模式")]),t._v(" "),s("td",[s("code",[t._v("cluster.switchToSinglePrimaryMode('root@192.168.15.98:3306')")])])]),t._v(" "),s("tr",[s("td",[t._v("更改集群设置")]),t._v(" "),s("td",[s("code",[t._v("cluster.setOption('clusterName','newCluster')")])])]),t._v(" "),s("tr",[s("td",[t._v("更改集群实例设置")]),t._v(" "),s("td",[s("code",[t._v("cluster.setInstanceOption('root@192.168.15.98:3306', 'exitStateAction', 'READ_ONLY')")])])])])]),t._v(" "),s("h2",{attrs:{id:"mysql-router"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mysql-router"}},[t._v("#")]),t._v(" MySQL Router")]),t._v(" "),s("p",[t._v("安装在"),s("code",[t._v("centos1(192.168.1.5)")]),t._v("上")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("yum "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" yum "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" mysql-router-community\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" /etc/security/limits.d/20-nproc.conf\n\nmysqlrouter soft nproc "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("65536")]),t._v("\nmysqlrouter hard nproc "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("65536")]),t._v("\nmysqlrouter soft nofile "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("65536")]),t._v("\nmysqlrouter hard nofile "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("65536")]),t._v("\n")])])]),s("p",[t._v("修改hosts")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vi /etc/hosts")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".1.5 centos1\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".1.6 mysql1\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".1.8 mysql2\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".1.10 mysql3\n")])])]),s("p",[t._v("引导MySQL Router")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("mysqlrouter "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--bootstrap")]),t._v(" root@mysql1:3306 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--directory")]),t._v(" /tmp/myrouter --conf-use-sockets "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--account")]),t._v(" routerfriend --account-create always "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--user")]),t._v(" mysqlrouter --conf-base-port "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7001")]),t._v("\n")])])]),s("p",[t._v("参考：https://dev.mysql.com/doc/mysql-router/8.0/en/mysql-router-deploying-bootstrapping.html")]),t._v(" "),s("p",[t._v("执行完成后会在"),s("code",[t._v("/tmp/myrouter")]),t._v("中生成如下文件，配置信息都写入到"),s("code",[t._v("mysqlrouter.conf")]),t._v("中，可以直接运行"),s("code",[t._v("start.sh")]),t._v("就可以运行起来")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# tree -L 2 /tmp/myrouter/")]),t._v("\n/tmp/myrouter/\n├── data\n│   ├── ca-key.pem\n│   ├── ca.pem\n│   ├── keyring\n│   ├── router-cert.pem\n│   ├── router-key.pem\n│   └── state.json\n├── log\n│   └── mysqlrouter.log\n├── mysqlro.sock\n├── mysqlrouter.conf\n├── mysqlrouter.key\n├── mysqlrouter.pid\n├── mysql.sock\n├── mysqlxro.sock\n├── mysqlx.sock\n├── run\n├── start.sh\n└── stop.sh\n")])])]),s("p",[t._v("iptables开放端口")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("iptables "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-I")]),t._v(" INPUT "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" tcp "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--dport")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7001")]),t._v(":7004 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-j")]),t._v(" ACCEPT\niptables "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-I")]),t._v(" INPUT "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" tcp "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--dport")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8334")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-j")]),t._v(" ACCEPT\niptables-save "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /etc/sysconfig/iptables\n")])])]),s("p",[t._v("7001端口是主要读写端口，客户端连接可以直接使用这个端口，这个端口在引导时指定(--conf-base-port 7001)")]),t._v(" "),s("p",[t._v("连接到"),s("code",[t._v("mysqlrouter")]),t._v("以后，可以执行以下SQL，查看当前连接的是哪一个实例")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" @"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@hostname")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("------------+")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" @"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@hostname")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("------------+")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" mysql1     "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("------------+")]),t._v("\n")])])]),s("h2",{attrs:{id:"遇到的问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#遇到的问题"}},[t._v("#")]),t._v(" 遇到的问题")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("全部节点宕机后集群无法恢复")])])]),t._v(" "),s("p",[t._v("如果所有节点全部宕机，再次启动MySQL后，集群不能自动恢复，且日志一直报错：")]),t._v(" "),s("blockquote",[s("p",[t._v("2021-09-10T10:31:12.522728+08:00 0 [ERROR] [MY-011735] [Repl] Plugin group_replication report\ned: '[GCS] Error connecting to all peers. Member join failed. Local port: 33061'\n2021-09-10T10:31:13.539200+08:00 0 [ERROR] [MY-011735] [Repl] Plugin group_replication report\ned: '[GCS] The member was unable to join the group. Local port: 33061'")])]),t._v(" "),s("p",[t._v("先尝试登录mysqlsh，使用"),s("code",[t._v("cluster=dba.getCluster()")]),t._v("看提示什么错误，如果提示以下错误")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("Dba"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getCluster"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" This "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" is not available through a session to a standalone "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("instance")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("metadata exists"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" instance belongs to that metadata"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" but "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GR")]),t._v(" is not active"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("MYSQLSH")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("51314")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("表示该实例已经属于某个集群，但是"),s("code",[t._v("GR")]),t._v("没有启动，此时可以尝试使用"),s("code",[t._v("dba.rebootClusterFromCompleteOutage()")]),t._v("从集群完全宕机中重新启动集群，如果成功可以看到以下提示")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("Restoring the "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" cluster from complete outage"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n\nThe instance "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql2:3306'")]),t._v(" was part "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v(" the cluster configuration"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nWould you like to rejoin it to the cluster"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("y"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("N")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" y\n\nThe instance "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql3:3306'")]),t._v(" was part "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v(" the cluster configuration"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nWould you like to rejoin it to the cluster"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("y"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("N")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" y\n\n"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("mysql1")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v(" was restored"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nRejoining "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql2:3306'")]),t._v(" to the cluster"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nRejoining instance "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql2:3306'")]),t._v(" to cluster "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dev'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\nThe instance "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql2:3306'")]),t._v(" was successfully rejoined to the cluster"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\nRejoining "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql3:3306'")]),t._v(" to the cluster"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nRejoining instance "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql3:3306'")]),t._v(" to cluster "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dev'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\nThe instance "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql3:3306'")]),t._v(" was successfully rejoined to the cluster"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\nThe cluster was successfully rebooted"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),s("p",[t._v("如果失败可能出现以下提示")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("Dba"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rebootClusterFromCompleteOutage"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" The active session instance isn"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'t the most updated in comparison with the ONLINE instances of the Cluster'")]),t._v("s metadata"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" Please use the most up to date instance"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql2:3306'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RuntimeError"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("表示本实例不是最新，可以在它提示的实例上执行"),s("code",[t._v("dba.rebootClusterFromCompleteOutage()")]),t._v("操作")]),t._v(" "),s("p",[t._v("也有可能一直报ERROR，"),s("code",[t._v("GR")]),t._v("一直不能启动，导致系统内存消耗不断增加，"),s("strong",[t._v("有可能造成内存溢出，服务器死机")]),t._v("。如果暂时无法恢复集群，必须先停掉MySQL服务，并kill掉MySQL 33061占用的线程。")]),t._v(" "),s("p",[t._v("此时可以尝试选择一个引导节点，如mysql1，查看组复制状态为OFFLINE")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" performance_schema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("replication_group_members"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("---------------------------+--------------------------------------+-------------+-------------+--------------+")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" CHANNEL_NAME              "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" MEMBER_ID                            "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" MEMBER_HOST "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" MEMBER_PORT "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" MEMBER_STATE "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("---------------------------+--------------------------------------+-------------+-------------+--------------+")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" group_replication_applier "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("63")]),t._v("ed2616"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1118")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v("ec"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ab0b"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("000")]),t._v("c298e6c6c "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("    mysql1   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" OFFLINE      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("---------------------------+--------------------------------------+-------------+-------------+--------------+")]),t._v("\n")])])]),s("p",[t._v("在该节点上执行以下SQL")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GLOBAL")]),t._v(" GROUP_REPLICATION_BOOTSTRAP_GROUP"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("START")]),t._v(" GROUP_REPLICATION"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GLOBAL")]),t._v(" GROUP_REPLICATION_BOOTSTRAP_GROUP"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OFF")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("再次查看状态，已经变成ONLINE，成员角色变成PRIMARY")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" performance_schema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("replication_group_members\\G\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("row")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n  CHANNEL_NAME: group_replication_applier\n     MEMBER_ID: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("63")]),t._v("ed2616"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1118")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v("ec"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ab0b"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("000")]),t._v("c298e6c6c\n   MEMBER_HOST: mysql1\n   MEMBER_PORT: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("\n  MEMBER_STATE: ONLINE\n   MEMBER_ROLE: "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PRIMARY")]),t._v("\nMEMBER_VERSION: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.0")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".26")]),t._v("\n")])])]),s("p",[t._v("然后在其他节点(mysql2,mysql3)上执行以下SQL")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("START")]),t._v(" GROUP_REPLICATION"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("再次查看状态")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" performance_schema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("replication_group_members\\G\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("row")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n  CHANNEL_NAME: group_replication_applier\n     MEMBER_ID: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("23")]),t._v("d316d0"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1120")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v("ec"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("fb6"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("000")]),t._v("c292aaf5d\n   MEMBER_HOST: mysql2\n   MEMBER_PORT: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("\n  MEMBER_STATE: ONLINE\n   MEMBER_ROLE: SECONDARY\nMEMBER_VERSION: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.0")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".26")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("row")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n  CHANNEL_NAME: group_replication_applier\n     MEMBER_ID: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("63")]),t._v("ed2616"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1118")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v("ec"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ab0b"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("000")]),t._v("c298e6c6c\n   MEMBER_HOST: mysql1\n   MEMBER_PORT: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("\n  MEMBER_STATE: ONLINE\n   MEMBER_ROLE: "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PRIMARY")]),t._v("\nMEMBER_VERSION: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.0")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".26")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("row")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n  CHANNEL_NAME: group_replication_applier\n     MEMBER_ID: c5adb336"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1122")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v("ec"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9239")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("000")]),t._v("c2999c716\n   MEMBER_HOST: mysql3\n   MEMBER_PORT: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),t._v("\n  MEMBER_STATE: ONLINE\n   MEMBER_ROLE: SECONDARY\nMEMBER_VERSION: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.0")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".26")]),t._v("\n")])])]),s("p",[t._v("可以登录mysqlsh查看状态"),s("code",[t._v("cluster.status()")])]),t._v(" "),s("p",[t._v("参看：https://stackoverflow.com/questions/49837554/mysql-group-replication-timeout-while-waiting-for-the-group-communication-engin")])])}),[],!1,null,null,null);s.default=e.exports}}]);