(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{243:function(a,t,s){"use strict";s.r(t);var e=s(6),n=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[a._v("#")]),a._v(" 安装")]),a._v(" "),t("h2",{attrs:{id:"目录规划"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#目录规划"}},[a._v("#")]),a._v(" 目录规划")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("/home/mysql/u01/mysql-5.6.39     "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# mysql根目录(软链接)")]),a._v("\n├── binlog     "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# binlog和relay log目录")]),a._v("\n│ ├── binlog.000001\n│ ├── binlog.000002\n│ ├── binlog.000003\n│ └── binlog.index\n├── data     "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 数据目录")]),a._v("\n├── etc     "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 配置文件目录")]),a._v("\n│ └── my.cnf\n├── ibdata     "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# innodb共享表空间目录")]),a._v("\n├── iblog     "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# redo log目录")]),a._v("\n├── log      "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 错误日志、慢查询日志目录")]),a._v("\n│ ├── error.log\n│ └── slow.log\n├── run     "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# MySQL运行文件目录")]),a._v("\n│ ├── mysqld.pid\n│ └── mysql.sock\n├── src     "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# MySQL源码目录")]),a._v("\n└── tmp     "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 临时文件目录")]),a._v("\n")])])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),t("p",[a._v("执行命令 "),t("code",[a._v("tree ~/u01/mysql-5.6.39 –L 2")]),a._v(" 可查看目录结构")])]),a._v(" "),t("h2",{attrs:{id:"准备"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#准备"}},[a._v("#")]),a._v(" 准备")]),a._v(" "),t("h3",{attrs:{id:"删除系统自带的my-cnf"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除系统自带的my-cnf"}},[a._v("#")]),a._v(" 删除系统自带的my.cnf")]),a._v(" "),t("p",[t("code",[a._v("CentOS")]),a._v(" 上可能会默认安装 "),t("code",[a._v("mariadb-libs")]),a._v(" ，在 "),t("code",[a._v("/etc/")]),a._v(" 下有如果有一个 "),t("code",[a._v("my.cnf")]),a._v(" 就删除")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" /etc/my.cnf /etc/my.cnf.bak\n")])])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),t("p",[t("code",[a._v("MySQL")]),a._v(" 默认会加载在编译时指定的配置文件目录中的 "),t("code",[a._v("my.cnf")]),a._v(" ，如 "),t("code",[a._v("-DSYSCONFDIR=/home/mysql/u01/mysql-5.6.39/etc")]),a._v(" 。如果没有指定，"),t("code",[a._v("MySQL")]),a._v(" 默认按照顺序查找并加载 "),t("code",[a._v("my.cnf")]),a._v(" ，如果在多个 "),t("code",[a._v("my.cnf")]),a._v(" 文件中存在相同的参数， "),t("code",[a._v("MySQL")]),a._v(" 以最后读到的参数为准。使用 "),t("code",[a._v("mysql --help | grep -A 1 'Default options'")]),a._v(" 可查看 "),t("code",[a._v("my.cnf")]),a._v(" 的加载顺序")])]),a._v(" "),t("h3",{attrs:{id:"依赖包和工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#依赖包和工具"}},[a._v("#")]),a._v(" 依赖包和工具")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("yum "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("unzip")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("bzip2")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("screen")]),a._v(" cmake gcc gcc-c++ autoconf ncurses ncurses-devel libaio libaio-devel libxml openssl openssl-devel readline readline-devel bison\n")])])]),t("h3",{attrs:{id:"用户"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用户"}},[a._v("#")]),a._v(" 用户")]),a._v(" "),t("p",[a._v("创建专用于运行和管理 "),t("code",[a._v("MySQL")]),a._v(" 服务的用户 "),t("code",[a._v("mysql")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("useradd")]),a._v(" mysql\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"PASSWORD"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("passwd")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--stdin")]),a._v(" mysql\n")])])]),t("p",[a._v("编辑 "),t("code",[a._v("/etc/security/limits.d/20-nproc.conf")]),a._v(" 文件设置 "),t("code",[a._v("mysql")]),a._v(" 用户的最大打开文件数和最大进程数")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("mysql   soft    nproc   "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("65535")]),a._v("\nmysql   hard    nproc   "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("65535")]),a._v("\nmysql   soft    nofile  "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("65535")]),a._v("\nmysql   hard    nofile  "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("65535")]),a._v("\n")])])]),t("p",[t("code",[a._v("ulimit")]),a._v(" 值根据系统情况设置，可参考 "),t("code",[a._v("cat /proc/sys/fs/file-max")]),a._v(" ，不能大于 "),t("code",[a._v("file-max")]),a._v(" ，设置后最好重启一次系统")]),a._v(" "),t("h2",{attrs:{id:"编译"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#编译"}},[a._v("#")]),a._v(" 编译")]),a._v(" "),t("p",[a._v("切换到 "),t("code",[a._v("mysql")]),a._v(" 用户")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("su")]),a._v(" - mysql\n")])])]),t("p",[a._v("创建所需要的目录和文件")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" ~/u01/mysql-5.6.39/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("src,data,ibdata,iblog,binlog,etc,log,run,tmp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("touch")]),a._v(" ~/u01/mysql-5.6.39/log/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("error.log,slow.log"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),t("p",[t("code",[a._v("MySQL")]),a._v(" 所要用到的目录和文件需要事先创建好， "),t("code",[a._v("MySQL")]),a._v(" 在启动时不会主动去创建这些文件，例如 "),t("code",[a._v("err.log")]),a._v(" 和 "),t("code",[a._v("tmp")]),a._v(" 目录，否则可能会报错，提示文件或目录不存在")])]),a._v(" "),t("p",[a._v("编译后安装")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" ~/u01/mysql-5.6.39/src\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://dev.mysql.com/get/Downloads/MySQL-5.6/mysql-5.6.39.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" zxf mysql-5.6.39.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" mysql-5.6.39\ncmake "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DCMAKE_INSTALL_PREFIX")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/home/mysql/u01/mysql-5.6.39 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DSYSCONFDIR")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/home/mysql/u01/mysql-5.6.39/etc "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DMYSQL_DATADIR")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/home/mysql/u01/mysql-5.6.39/data "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DMYSQL_UNIX_ADDR")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/home/mysql/u01/mysql-5.6.39/run/mysql.sock "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DWITH_INNOBASE_STORAGE_ENGINE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DWITH_MYISAM_STORAGE_ENGINE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DWITH_ARCHIVE_STORAGE_ENGINE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DWITH_PARTITION_STORAGE_ENGINE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DWITH_FEDERATED_STORAGE_ENGINE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DWITH_BLACKHOLE_STORAGE_ENGINE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DWITH_ZLIB")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("bundled "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DEXTRA_CHARSETS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("all "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DDEFAULT_CHARSET")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("utf8 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DDEFAULT_COLLATION")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("utf8_general_ci "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DENABLED_LOCAL_INFILE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DWITH_READLINE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DWITH_EMBEDDED_SERVER")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DWITH_READLINE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DWITH_SSL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("yes\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-j4")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v("\n")])])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),t("p",[t("code",[a._v("-j4")]),a._v(" 参数表示启用 "),t("code",[a._v("4")]),a._v(" 个线程来执行编译操作，可有效减少编译时间")])]),a._v(" "),t("table",[t("thead",[t("tr",[t("th",[a._v("编译参数")]),a._v(" "),t("th",[a._v("说明")])])]),a._v(" "),t("tbody",[t("tr",[t("td",[a._v("-DCMAKE_INSTALL_PREFIX")]),a._v(" "),t("td",[a._v("MySQL安装目录")])]),a._v(" "),t("tr",[t("td",[a._v("-DSYSCONFDIR")]),a._v(" "),t("td",[a._v("my.cnf所在的目录")])]),a._v(" "),t("tr",[t("td",[a._v("-DMYSQL_DATADIR")]),a._v(" "),t("td",[a._v("数据目录")])]),a._v(" "),t("tr",[t("td",[a._v("-DMYSQL_UNIX_ADDR")]),a._v(" "),t("td",[a._v("socket文件路径")])]),a._v(" "),t("tr",[t("td",[a._v("-DWITH_INNOBASE_STORAGE_ENGINE")]),a._v(" "),t("td",[a._v("是否启用innodb存储引擎，下同")])]),a._v(" "),t("tr",[t("td",[a._v("-DWITH_MYISAM_STORAGE_ENGINE")]),a._v(" "),t("td")]),a._v(" "),t("tr",[t("td",[a._v("-DWITH_ARCHIVE_STORAGE_ENGINE")]),a._v(" "),t("td")]),a._v(" "),t("tr",[t("td",[a._v("-DWITH_PARTITION_STORAGE_ENGINE")]),a._v(" "),t("td")]),a._v(" "),t("tr",[t("td",[a._v("-DWITH_FEDERATED_STORAGE_ENGINE")]),a._v(" "),t("td")]),a._v(" "),t("tr",[t("td",[a._v("-DWITH_BLACKHOLE_STORAGE_ENGINE")]),a._v(" "),t("td")]),a._v(" "),t("tr",[t("td",[a._v("-DWITH_ZLIB")]),a._v(" "),t("td",[a._v("指定zlib，bundled表示使用MySQL源码包带的zlib")])]),a._v(" "),t("tr",[t("td",[a._v("-DEXTRA_CHARSETS")]),a._v(" "),t("td",[a._v("除了默认字符编码意外，还支持的字符编码")])]),a._v(" "),t("tr",[t("td",[a._v("-DDEFAULT_CHARSET")]),a._v(" "),t("td",[a._v("默认字符编码")])]),a._v(" "),t("tr",[t("td",[a._v("-DDEFAULT_COLLATION")]),a._v(" "),t("td",[a._v("默认字符校验集")])]),a._v(" "),t("tr",[t("td",[a._v("-DENABLED_LOCAL_INFILE")]),a._v(" "),t("td",[a._v("是否允许导入本地数据文件")])]),a._v(" "),t("tr",[t("td",[a._v("-DWITH_READLINE")]),a._v(" "),t("td",[a._v("是否启用readline")])]),a._v(" "),t("tr",[t("td",[a._v("-DWITH_EMBEDDED_SERVER")]),a._v(" "),t("td",[a._v("是否启用embedded server库")])]),a._v(" "),t("tr",[t("td",[a._v("-DWITH_READLINE")]),a._v(" "),t("td",[a._v("是否启用readline")])]),a._v(" "),t("tr",[t("td",[a._v("-DWITH_SSL=yes")]),a._v(" "),t("td",[a._v("是否启用SSL")])])])]),a._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),t("p",[a._v("也可以直接使用编译好的二进制包，例如 "),t("code",[a._v("mysql-5.6.39-linux-glibc2.12-x86_64.tar.gz")]),a._v(" ，该二进制包需要 "),t("code",[a._v("glibc2.12")]),a._v(" 版本支持，可使用 "),t("code",[a._v("ldd --version")]),a._v(" 命令查看 "),t("code",[a._v("glibc")]),a._v(" 版本")])]),a._v(" "),t("h2",{attrs:{id:"优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#优化"}},[a._v("#")]),a._v(" 优化")]),a._v(" "),t("p",[a._v("创建根目录软连接")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("ln")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" /home/mysql/u01/mysql-5.6.39 /home/mysql/u01/mysql\n")])])]),t("p",[a._v("链接头文件和库文件")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("ln")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-sf")]),a._v(" /home/mysql/u01/mysql/include /usr/include/mysql\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("bash")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'echo \"/home/mysql/u01/mysql/lib\" >> /etc/ld.so.conf.d/mysql.conf'")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" ldconfig\n")])])]),t("p",[a._v("设置环境变量")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("bash")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'echo \"export PATH=/home/mysql/u01/mysql/bin:$PATH\" >> /etc/profile.d/mysql.sh'")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" +x /etc/profile.d/mysql.sh\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v(" /etc/profile.d/mysql.sh\n")])])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),t("p",[t("code",[a._v("MySQL")]),a._v(" 的环境变量路径放在 "),t("code",[a._v("$PATH")]),a._v(" 前面，好处是就算系统存在其他的 "),t("code",[a._v("mysql")]),a._v(" 命令，也会首先读取 "),t("code",[a._v("/home/mysql/u01/mysql/bin")]),a._v(" 下的命令，而忽略其他的 "),t("code",[a._v("mysql")]),a._v(" 命令")])]),a._v(" "),t("h2",{attrs:{id:"配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置文件"}},[a._v("#")]),a._v(" 配置文件")]),a._v(" "),t("div",{staticClass:"language-ini extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# /home/mysql/u01/mysql-5.6.39/etc/my.cnf")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("client")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("port")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("3306")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("socket")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-5.6.39/run/mysql.sock")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("mysql")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\nauto-rehash\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("prompt")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token inner-value"}},[a._v("\\\\u@\\\\h \\\\d>")]),a._v('"')]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("mysqld")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("autocommit")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("general_log")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("OFF")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("explicit_defaults_for_timestamp")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("true")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("interactive_timeout")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("600")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("wait_timeout")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("600")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# system")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("user")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("mysql")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("port")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("3306")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("basedir")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-5.6.39")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("datadir")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-5.6.39/data")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("tmpdir")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-5.6.39/tmp")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("socket")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-5.6.39/run/mysql.sock")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("pid-file")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-5.6.39/run/mysqld.pid")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("max_allowed_packet")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1G")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("max_connections")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("3000")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("max_user_connections")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("2800")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("open_files_limit")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("65535")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server_id")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("101")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("sql_mode")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("skip_name_resolve")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transaction_isolation")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("READ-COMMITTED")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("default_storage_engine")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("InnoDB")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("gtid_mode")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("enforce_gtid_consistency")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# binlog")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("log_bin")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-5.6.39/binlog/binlog")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("binlog_cache_size")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("32768")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("binlog_format")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ROW")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("expire_logs_days")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("14")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("max_binlog_cache_size")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("2G")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("max_binlog_size")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("500M")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("sync_binlog")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# replication")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("relay_log")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-5.6.39/log/relaylog")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("relay_log_index")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-5.6.39/log/relay.index")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("relay_log_info_file")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-5.6.39/log/relay-log.info")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("slave_load_tmpdir")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-5.6.39/tmp")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("log_slave_updates")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("slave-net-timeout")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("60")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("slave_skip_errors")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("OFF")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("sync-master-info")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("sync-relay-log")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("sync-relay-log-info")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\nskip-slave-start\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# logging")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("log_error")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-5.6.39/log/error.log")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("long_query_time")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("slow_query_log")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("slow_query_log_file")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-5.6.39/log/slow.log")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("log_queries_not_using_indexes")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("log_throttle_queries_not_using_indexes")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("10")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("log_slow_admin_statements")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# innodb")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_data_home_dir")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-5.6.39/ibdata")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_log_group_home_dir")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-5.6.39/iblog")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_adaptive_flushing")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_adaptive_hash_index")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_autoinc_lock_mode")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_buffer_pool_instances")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("8")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_buffer_pool_size")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("10G")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_change_buffering")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("inserts")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_checksums")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_data_file_path")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ibdata1:32M;ibdata2:16M:autoextend")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_doublewrite")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_file_format")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("Barracuda")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_file_per_table")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_flush_log_at_trx_commit")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_flush_method")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("O_DIRECT")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_io_capacity")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("300")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_lock_wait_timeout")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("10")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_log_buffer_size")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("64M")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_log_file_size")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("256M")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_log_files_in_group")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("2")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_max_dirty_pages_pct")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("75")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_open_files")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("60000")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_stats_on_metadata")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("OFF")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_support_xa")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_use_native_aio")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("OFF")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_read_io_threads")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("4")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_purge_threads")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_write_io_threads")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("10")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("myisamchk")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("key_buffer_size")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("20M")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("sort_buffer_size")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("20M")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("read_buffer")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("2M")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("write_buffer")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("2M")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("mysqlhotcopy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\ninteractive-timeout\n")])])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),t("p",[a._v("如果在安装的时候没有指定服务器默认编码，那么 MySQL 会以 "),t("code",[a._v("latin1")]),a._v(" 作为默认编码，在 "),t("code",[a._v("my.cnf")]),a._v(" 的 "),t("code",[a._v("[mysqld]")]),a._v(" 中加入 "),t("code",[a._v("character_set_server = utf8")]),a._v(" 可以更改 MySQL 的默认编码")])]),a._v(" "),t("h2",{attrs:{id:"初始化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#初始化"}},[a._v("#")]),a._v(" 初始化")]),a._v(" "),t("p",[a._v("初始化时需要指定 "),t("code",[a._v("MySQL")]),a._v(" 根目录 "),t("code",[a._v("--basedir")]),a._v(" 、数据目录 "),t("code",[a._v("--datadir")]),a._v(" 和运行用户 "),t("code",[a._v("--user")]),a._v(" ，并会在根目录下的 "),t("code",[a._v("data")]),a._v(" 目录中创建三个数据库 "),t("code",[a._v("mysql")]),a._v(" "),t("code",[a._v("performance_schema")]),a._v(" "),t("code",[a._v("test")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("/home/mysql/u01/mysql/scripts/mysql_install_db "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--basedir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/home/mysql/u01/mysql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--datadir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/home/mysql/u01/mysql/data "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql\n")])])]),t("h2",{attrs:{id:"启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[a._v("#")]),a._v(" 启动")]),a._v(" "),t("h3",{attrs:{id:"使用mysql自带脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用mysql自带脚本"}},[a._v("#")]),a._v(" 使用MySQL自带脚本")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" /home/mysql/u01/mysql/support-files/mysql.server /etc/init.d/mysqld\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" u+x /etc/init.d/mysqld\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" mysqld start\n")])])]),t("h3",{attrs:{id:"编写脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#编写脚本"}},[a._v("#")]),a._v(" 编写脚本")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[a._v("#!/bin/bash")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v(" /etc/init.d/functions\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("mysql_user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("root\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("port")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3306")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("mysql_bin_path")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/home/mysql/u01/mysql/bin"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("mysql_socket")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/home/mysql/u01/mysql/run/mysql.sock"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("mysql_conf")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/home/mysql/u01/mysql/etc/my.cnf"')]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function-name function"}},[a._v("start_mysql")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$mysql_socket")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("then")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"MySQL Server is running..."')]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exit")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("else")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$mysql_bin_path")]),a._v("/mysqld_safe --defaults-file"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$mysql_conf")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" /dev/null "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$?")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("then")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sleep")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("\n            action "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Start MySQL"')]),a._v(" /bin/true\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("else")]),a._v("\n            action "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Start MySQL"')]),a._v(" /bin/false\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("fi")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("fi")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function-name function"}},[a._v("stop_mysql")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$mysql_socket")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("then")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$mysql_bin_path")]),a._v("/mysqladmin -u"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$mysql_user")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--socket")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$mysql_socket")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("shutdown")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" /dev/null\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$?")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("then")]),a._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#sleep 2")]),a._v("\n            action "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Stop MySQL"')]),a._v(" /bin/true\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("else")]),a._v("\n            action "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Stop MySQL"')]),a._v(" /bin/false\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("fi")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("else")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"MySQL Server is stopped..."')]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exit")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("fi")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function-name function"}},[a._v("restart_mysql")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    stop_mysql\n    start_mysql\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("case")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v("\n    start   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n        start_mysql\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    stop    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n        stop_mysql\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    restart "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n        restart_mysql\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    *   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Usage: '),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$mysql_bin_path")]),a._v("/mysqld_job {start|stop|restart}"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[a._v("\\n")]),a._v('"')]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("esac")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exit")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("\n")])])]),t("h3",{attrs:{id:"初始化配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#初始化配置"}},[a._v("#")]),a._v(" 初始化配置")]),a._v(" "),t("p",[a._v("第一次启动 "),t("code",[a._v("MySQL")]),a._v(" 建议运行 "),t("code",[a._v("mysql_secure_installation")]),a._v(" 命令进行初始化设置，密码、安全等配置，"),t("code",[a._v("mysql_secure_installation")]),a._v(" 位于根目录下的 "),t("code",[a._v("bin")]),a._v(" 目录中")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("mysql_secure_installation\n")])])]),t("p",[a._v("也可以通过 "),t("code",[a._v("mysqladmin")]),a._v(" 来设置密码")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("mysqladmin "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-uroot")]),a._v(" password "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'NEWPASS'")]),a._v("\n")])])]),t("h2",{attrs:{id:"多实例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#多实例"}},[a._v("#")]),a._v(" 多实例")]),a._v(" "),t("h3",{attrs:{id:"目录规划-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#目录规划-2"}},[a._v("#")]),a._v(" 目录规划")]),a._v(" "),t("p",[a._v("以端口号来划分多实例目录，如 "),t("code",[a._v("3306")]),a._v(" "),t("code",[a._v("3307")]),a._v(" "),t("code",[a._v("3308")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("/home/mysql/u01/mysql-multi\n├── "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3306")]),a._v("\n│   ├── binlog\n│   ├── data\n│   ├── etc\n│   ├── ibdata\n│   ├── iblog\n│   ├── log\n│   ├── run\n│   └── tmp\n├── "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3307")]),a._v("\n│   ├── binlog\n│   ├── data\n│   ├── etc\n│   ├── ibdata\n│   ├── iblog\n│   ├── log\n│   ├── run\n│   └── tmp\n├── "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3308")]),a._v("\n│   ├── binlog\n│   ├── data\n│   ├── etc\n│   ├── ibdata\n│   ├── iblog\n│   ├── log\n│   ├── run\n│   └── tmp\n└── src\n")])])]),t("h3",{attrs:{id:"创建实例目录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建实例目录"}},[a._v("#")]),a._v(" 创建实例目录")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" ~/u01/mysql-multi/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3306,3307")]),a._v(",3308"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("data,ibdata,iblog,binlog,etc,log,run,tmp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("touch")]),a._v(" ~/u01/mysql-multi/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3306,3307")]),a._v(",3308"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("/log/error.log\n")])])]),t("h3",{attrs:{id:"实例配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#实例配置文件"}},[a._v("#")]),a._v(" 实例配置文件")]),a._v(" "),t("div",{staticClass:"language-ini extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# /home/mysql/u01/mysql-multi/3306/etc/my.cnf")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("client")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("port")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("3306")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("socket")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-multi/3306/run/mysql.sock")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("mysql")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\nauto-rehash\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("prompt")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token inner-value"}},[a._v("\\\\u@\\\\h \\\\d>")]),a._v('"')]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("mysqld")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("autocommit")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("general_log")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("OFF")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("explicit_defaults_for_timestamp")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("true")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("interactive_timeout")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("600")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("wait_timeout")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("300")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# system")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("user")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("mysql")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("port")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("3306")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("basedir")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-5.6.39")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("datadir")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-multi/3306/data")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("tmpdir")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-multi/3306/tmp")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("socket")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-multi/3306/run/mysql.sock")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("pid-file")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-multi/3306/run/mysqld.pid")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("max_allowed_packet")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1G")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("max_connections")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("3000")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("max_user_connections")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("2800")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("open_files_limit")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("65535")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server_id")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("101")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("sql_mode")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("skip_name_resolve")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transaction_isolation")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("READ-COMMITTED")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("default_storage_engine")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("InnoDB")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("gtid_mode")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("enforce_gtid_consistency")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# binlog")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("log_bin")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-multi/3306/binlog/binlog")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("binlog_cache_size")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("32768")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("binlog_format")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ROW")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("expire_logs_days")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("14")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("log_slave_updates")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("max_binlog_cache_size")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("2147483648")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("max_binlog_size")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("524288000")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("sync_binlog")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# relay")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("relay_log")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-multi/3306/log/relaylog")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("relay_log_index")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-multi/3306/log/relay.index")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("relay_log_info_file")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-multi/3306/log/relay-log.info")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# slave")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("slave_load_tmpdir")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-multi/3306/tmp")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("slave_skip_errors")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("OFF")]),a._v("\nskip-slave-start\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# logging")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("log_error")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-multi/3306/log/error.log")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("long_query_time")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("slow_query_log")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("slow_query_log_file")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-multi/3306/log/slow.log")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("log_queries_not_using_indexes")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("log_throttle_queries_not_using_indexes")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("10")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("log_slow_admin_statements")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# innodb")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_data_home_dir")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-multi/3306/ibdata")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_log_group_home_dir")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("/home/mysql/u01/mysql-multi/3306/iblog")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_adaptive_flushing")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_adaptive_hash_index")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_autoinc_lock_mode")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_buffer_pool_instances")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_buffer_pool_size")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("200M")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_change_buffering")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("inserts")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_checksums")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_data_file_path")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ibdata1:32M;ibdata2:16M:autoextend")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_doublewrite")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_file_format")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("Barracuda")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_file_per_table")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_flush_log_at_trx_commit")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_flush_method")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("O_DIRECT")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_io_capacity")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("300")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_lock_wait_timeout")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("10")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_log_buffer_size")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("67108864")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_log_file_size")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1048576000")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_log_files_in_group")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("2")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_max_dirty_pages_pct")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("75")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_open_files")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("60000")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_stats_on_metadata")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("OFF")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_support_xa")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ON")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_use_native_aio")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("OFF")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_read_io_threads")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("4")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_purge_threads")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("innodb_write_io_threads")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("10")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("myisamchk")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("key_buffer_size")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("20M")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("sort_buffer_size")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("20M")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("read_buffer")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("2M")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("write_buffer")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("2M")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token section"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token section-name selector"}},[a._v("mysqlhotcopy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")])]),a._v("\ninteractive-timeout\n")])])]),t("p",[a._v("其他实例的配置文件对照 "),t("code",[a._v("3306")]),a._v(" 设置， 只需要修改 "),t("code",[a._v("3306")]),a._v(" 为对应的实例端口号")]),a._v(" "),t("h3",{attrs:{id:"初始化-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#初始化-2"}},[a._v("#")]),a._v(" 初始化")]),a._v(" "),t("p",[a._v("初始化时需要指定对应实例的 "),t("code",[a._v("--datadir")]),a._v(" 目录")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("/home/mysql/u01/mysql/scripts/mysql_install_db "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--basedir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/home/mysql/u01/mysql-5.6.39 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--datadir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/home/mysql/u01/mysql-multi/3306/data "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql\n")])])]),t("h3",{attrs:{id:"启动-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动-2"}},[a._v("#")]),a._v(" 启动")]),a._v(" "),t("p",[a._v("启动时需要指定对应配置文件 "),t("code",[a._v("--defaults-file")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("mysqld_safe --defaults-file"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/home/mysql/u01/mysql-multi/3306/etc/my.cnf "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" /dev/null "),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[a._v("2")]),a._v(">")]),t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[a._v("&1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v("\n")])])]),t("p",[a._v("如果是首次启动数据库，需要执行 "),t("code",[a._v("mysql_secure_installation")]),a._v(" 命令，初始化数据库设置，此时需要修改 "),t("code",[a._v("mysql_secure_installation")]),a._v(" 脚本")]),a._v(" "),t("p",[t("strong",[a._v("MySQL5.5")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("div",{staticClass:"highlight-lines"},[t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("div",{staticClass:"highlighted"},[a._v(" ")]),t("br"),t("br"),t("br")]),t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function-name function"}},[a._v("make_config")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"# mysql_secure_installation config file"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$config")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"[mysql]"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">>")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$config")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"user=root"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">>")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$config")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("esc_pass")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("basic_single_escape "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$rootpass")]),a._v('"')]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("\"password='"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$esc_pass")]),a._v("'\"")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">>")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$config")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"socket=/usr/local/mysql-5.5.59/mysql.sock"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">>")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$config")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 插入位置")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#sed 's,^,> ,' < $config # Debugging")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("p",[t("strong",[a._v("MySQL5.6")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("div",{staticClass:"highlight-lines"},[t("br"),t("br"),t("br"),t("br"),t("br"),t("br"),t("div",{staticClass:"highlighted"},[a._v(" ")]),t("br")]),t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("write_file"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$config")]),a._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"# mysql_secure_installation config file"')]),a._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"[mysql]"')]),a._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"user=root"')]),a._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("\"password='"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$esc_pass")]),a._v("'\"")]),a._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"connect-expired-password"')]),a._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"socket=/home/mysql/u01/mysql-5.6.39/run/mysql.sock"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 插入位置")]),a._v("\n")])])]),t("h3",{attrs:{id:"设置或修改root密码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置或修改root密码"}},[a._v("#")]),a._v(" 设置或修改root密码")]),a._v(" "),t("p",[a._v("设置或修改时需要指定 "),t("code",[a._v("socket")]),a._v(" 路径")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("mysqladmin "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-uroot")]),a._v(" password "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'NEWPASS'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--socket")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/home/mysql/u01/mysql-multi/3306/run/mysql.sock\n")])])]),t("h3",{attrs:{id:"停止服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#停止服务"}},[a._v("#")]),a._v(" 停止服务")]),a._v(" "),t("p",[a._v("同样需要指定 "),t("code",[a._v("socket")]),a._v(" 路径")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("mysqladmin "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" root "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" PASSWORD "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--socket")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/home/mysql/u01/mysql-multi/3306/run/mysql.sock "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("shutdown")]),a._v("\n")])])]),t("h3",{attrs:{id:"客户端登录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#客户端登录"}},[a._v("#")]),a._v(" 客户端登录")]),a._v(" "),t("p",[a._v("在服务器上登录 "),t("code",[a._v("MySQL")]),a._v(" 多实例时，需要指定 "),t("code",[a._v("socket")]),a._v(" 路径，同时最好也指定对应的配置文件，如果是远程登录，则是指定服务端口")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("mysql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--socket")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/home/mysql/u01/mysql-multi/3306/run/mysql.sock "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-uroot")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v("\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);