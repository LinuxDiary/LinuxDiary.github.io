(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{249:function(s,a,e){"use strict";e.r(a);var t=e(6),r=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"实时监控工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实时监控工具"}},[s._v("#")]),s._v(" 实时监控工具")]),s._v(" "),a("h2",{attrs:{id:"mytop"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mytop"}},[s._v("#")]),s._v(" mytop")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" mytop\n")])])]),a("h3",{attrs:{id:"监控界面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#监控界面"}},[s._v("#")]),s._v(" 监控界面")]),s._v(" "),a("div",{staticClass:"language-text extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("MySQL on localhost (5.6.39-log)                                      up 69+10:09:56 [20:50:55]\n Queries: 92.1M  qps:   16 Slow:    1.0M         Se/In/Up/De(%):    48/13/02/00\n             qps now:    1 Slow qps: 0.3  Threads:   19 (   3/   7) 33/08/00/00\n Key Efficiency: 100.0%  Bps in/out:  2.4k/10.2k   Now in/out: 107.4/ 1.2k\n\n      Id      User         Host/IP         DB      Time    Cmd Query or State\n       --      ----         -------         --      ----    --- ----------\n    49672      root       localhost        db1         0  Query show full processlist\n    15358 zhcj_user    192.168.1.13        db1         2  Sleep\n    22902 zhcj_user    192.168.1.13        db1         2  Sleep\n")])])]),a("h3",{attrs:{id:"帮助界面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#帮助界面"}},[s._v("#")]),s._v(" 帮助界面")]),s._v(" "),a("p",[s._v("键入 "),a("code",[s._v("?")]),s._v(" 可以显示帮助信息")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("  ? - display this screen\n  # - toggle short/long numbers (not yet implemented)\n  c - command summary view (based on Com_* counters)\n  d - show only a specific database\n  e - explain the query that a thread is running\n  f - show full query info for a given thread\n  F - unFilter the dispaly\n  h - show only a specifc host's connections\n  H - toggle the mytop header\n  i - toggle the display of idle (sleeping) threads\n  I - show innodb status\n  k - kill a thread\n  p - pause the display\n  m - switch [mode] to qps (queries/sec) scrolling view\n  o - reverse the sort order (toggle)\n  q - quit\n  r - reset the status counters (via FLUSH STATUS on your server)\n  s - change the delay between screen updates\n  t - switch to thread view (default)\n  u - show only a specific user\n  : - enter a command (not yet implemented)\n")])])]),a("h3",{attrs:{id:"基本用法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本用法"}},[s._v("#")]),s._v(" 基本用法")]),s._v(" "),a("p",[a("code",[s._v("mytop")]),s._v(" 与 "),a("code",[s._v("mysql")]),s._v(" 命令相似，使用时需要制定 "),a("code",[s._v("user")]),s._v(" "),a("code",[s._v("password")]),s._v(" "),a("code",[s._v("socket")]),s._v(" "),a("code",[s._v("host")]),s._v(" "),a("code",[s._v("port")]),s._v(" 等参数，详细参数可参考 "),a("code",[s._v("man mytop")]),s._v(" 。使用 "),a("code",[s._v("--prompt")]),s._v(" 选项表示使用提示输入密码，否则就需要在命令行中使用 "),a("code",[s._v("-p'PASSWORD'")]),s._v(" 或在配置文件中明文保存密码")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("mytop "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--prompt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-uroot")]),s._v("\n")])])]),a("p",[s._v("也可以 "),a("code",[s._v("~/.mytop")]),s._v(" 中建立默认的连接信息配置文件")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("pass")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("PASSWORD\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("host")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("localhost\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("db")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("test\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("delay")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("port")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("socket")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n")])])]),a("h2",{attrs:{id:"innotop"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#innotop"}},[s._v("#")]),s._v(" innotop")]),s._v(" "),a("p",[a("code",[s._v("innotop")]),s._v(" 是一个监控 "),a("code",[s._v("InnoDB")]),s._v(" 引擎数据表的监控工具，实时的显示 "),a("code",[s._v("InnoDB")]),s._v(" 的各种状态")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("yum "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" innotop\n")])])]),a("h3",{attrs:{id:"监控界面-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#监控界面-2"}},[s._v("#")]),s._v(" 监控界面")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[RO] Dashboard (? for help)        localhost, 69d, 16.10 QPS, 18/2/7 con/run/cac thds, 5.6.39-log\n\nUptime  MaxSQL  ReplLag  QPS    Cxns  Run  Miss  Lock  Tbls  Repl  SQL\n   69d                   16.10    18       0.08     0   111\n")])])]),a("h3",{attrs:{id:"帮助界面-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#帮助界面-2"}},[s._v("#")]),s._v(" 帮助界面")]),s._v(" "),a("p",[s._v("键入 "),a("code",[s._v("?")]),s._v(" 可以显示帮助界面")]),s._v(" "),a("div",{staticClass:"language-text extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("Switch to a different mode:\n   A  Dashboard         I  InnoDB I/O Info     Q  Query List\n   B  InnoDB Buffers    K  InnoDB Lock Waits   R  InnoDB Row Ops\n   C  Command Summary   L  Locks               S  Variables &amp; Status\n   D  InnoDB Deadlocks  M  Replication Status  T  InnoDB Txns\n   F  InnoDB FK Err     O  Open Tables         U  User Statistics\n\nActions:\n   d  Change refresh interval        q  Quit innotop\n   k  Kill a query's connection      r  Reverse sort order\n   n  Switch to the next connection  s  Choose sort column\n   p  Pause innotop                  x  Kill a query\n\nOther:\n TAB  Switch to the next server group   /  Quickly filter what you see\n   !  Show license and warranty         =  Toggle aggregation\n   #  Select/create server groups       @  Select/create server connections\n   $  Edit configuration settings       \\  Clear quick-filters\nPress any key to continue\n")])])]),a("h3",{attrs:{id:"基本用法-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本用法-2"}},[s._v("#")]),s._v(" 基本用法")]),s._v(" "),a("p",[s._v("与 "),a("code",[s._v("mytop")]),s._v(" 类似，可以通过 "),a("code",[s._v("man innotop")]),s._v(" 或 "),a("code",[s._v("innotop --help")]),s._v(" 获取详细说明，使用 "),a("code",[s._v("--askpass")]),s._v(" 参数提示用户输入密码，而不讲密码明文显示在命令行中")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("innotop "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--askpass")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-uroot")]),s._v("\n")])])]),a("h2",{attrs:{id:"mysqladmin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysqladmin"}},[s._v("#")]),s._v(" mysqladmin")]),s._v(" "),a("p",[a("code",[s._v("mysqladmin")]),s._v(" 是 "),a("code",[s._v("MySQL")]),s._v(" 自带的命令行工具，包含很多管理命令，详细通过 "),a("code",[s._v("mysqladmin --help")]),s._v(" 查看，常用的例如 "),a("code",[s._v("version")]),s._v(" "),a("code",[s._v("status")]),s._v(" 命令")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ mysqladmin "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-uroot")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" version\nmysqladmin  Ver "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.42")]),s._v(" Distrib "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.6")]),s._v(".39, "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" Linux on x86_64\nCopyright "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v(", Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nServer version      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.6")]),s._v(".39-log\nProtocol version    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\nConnection      Localhost via UNIX socket\nUNIX socket     /home/mysql56/u01/mysql-5.6.39/run/mysql.sock\nUptime:         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("69")]),s._v(" days "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" hours "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("49")]),s._v(" min "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" sec\n\nThreads: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v("  Questions: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("96755698")]),s._v("  Slow queries: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1059055")]),s._v("  Opens: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12564")]),s._v("  Flush tables: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("149")]),s._v("  Open tables: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("111")]),s._v("  Queries per second avg: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16.124")]),s._v("\n")])])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ mysqladmin "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-uroot")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" status\nUptime: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6000568")]),s._v("  Threads: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v("  Questions: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("96755987")]),s._v("  Slow queries: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1059055")]),s._v("  Opens: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12564")]),s._v("  Flush tables: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("149")]),s._v("  Open tables: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("111")]),s._v("  Queries per second avg: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16.124")]),s._v("\n")])])]),a("h2",{attrs:{id:"mysqltuner"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysqltuner"}},[s._v("#")]),s._v(" MySQLTuner")]),s._v(" "),a("p",[a("code",[s._v("MySQLTuner")]),s._v(" 是一个全面的 "),a("code",[s._v("MySQL")]),s._v(" 状态检查工具，包括错误日志、慢查询日志、存储引擎、缓存、安全等方面，能够提供一些性能优化的建议。")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://mysqltuner.pl/ "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-O")]),s._v(" mysqltuner.pl\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("700")]),s._v(" mysqltuner.pl\n")])])]),a("h3",{attrs:{id:"基本用法-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本用法-3"}},[s._v("#")]),s._v(" 基本用法")]),s._v(" "),a("p",[s._v("使用时可能需要指定 "),a("code",[s._v("host")]),s._v(" "),a("code",[s._v("port")]),s._v(" "),a("code",[s._v("user")]),s._v(" "),a("code",[s._v("password")]),s._v(" 等参数")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("perl mysqltuner.pl "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--user")]),s._v(" root "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--password")]),s._v(" PASSWORD\n")])])]),a("p",[s._v("输出结果到文件，如果指定了 "),a("code",[s._v("--silent")]),s._v(" ，命令将静默执行，屏幕没有任何输出")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("perl mysqltuner.pl "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--user")]),s._v(" root "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--password")]),s._v(" PASSWORD "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--outputfile")]),s._v(" /home/mysql/out.txt\n")])])]),a("p",[s._v("其他用法和说明参考："),a("a",{attrs:{href:"https://github.com/major/MySQLTuner-perl",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/major/MySQLTuner-perl"),a("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=r.exports}}]);